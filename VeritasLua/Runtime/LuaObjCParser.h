//
//  LuaObjCParser.h
//  LuaIOS
//
//  Created by LeixSnake on 9/19/12.
//
//

#define kLuaObjCParserString @"CmxvY2FsIHVucGFjayA9IHRhYmxlLnVucGFjawoKbG9jYWwgZ19FbmdpbmUKCmxvY2FsIGxwZWcgPSByZXF1aXJlICdscGVnJwpsb2NhbCBQLCBSLCBTLCBDLCBDYywgQ3QgPSBscGVnLlAsIGxwZWcuUiwgbHBlZy5TLCBscGVnLkMsIGxwZWcuQ2MsIGxwZWcuQ3QKCi0tIGNyZWF0ZSBhIHBhdHRlcm4gd2hpY2ggY2FwdHVyZXMgdGhlIGx1YSB2YWx1ZSBbaWRdIGFuZCB0aGUgaW5wdXQgbWF0Y2hpbmcKLS0gW3BhdHRdIGluIGEgdGFibGUKbG9jYWwgZnVuY3Rpb24gdG9rZW4oaWQsIHBhdHQpIAogICAgICAgICAgICAgICAgcmV0dXJuIEN0KENjKGlkKSAqIEMocGF0dCkpIAogICAgICAgICAgICAgICBlbmQKCmxvY2FsIGRpZ2l0ID0gUignMDknKQoKLS0gcmFuZ2Ugb2YgdmFsaWQgY2hhcmFjdGVycyBhZnRlciBmaXJzdCBjaGFyYWN0ZXIgb2YgaWRlbnRpZmllcgpsb2NhbCBpZHNhZmUgPSBSKCdBWicsICdheicsICdcMTI3XDI1NScpICsgUCAnXycKCi0tIG9wZXJhdG9ycwpsb2NhbCBvcGVyYXRvciA9IHRva2VuKCdvcGVyYXRvcicsIFAgJz09JyArIFAgJ349JyArIFAgJzw9JyArIFAgJz49JyArIFAgJy4uLicgKyBQJyE9JwogICAgICAgICAgICAgICAgICAgICAgICsgUCAnLi4nICsgUyAnKy0qLyVeIz08Pjs6LC57fVtdKCknKQotLSBpZGVudGlmaWVycwpsb2NhbCBpZGVudCA9IHRva2VuKCdpZGVudGlmaWVyJywgaWRzYWZlICogKGlkc2FmZSArIGRpZ2l0ICsgUCAnLicpIF4gMCkKCi0tIGtleXdvcmRzCmxvY2FsIG9sdWFfa2V5d29yZHMgPSBQICdAaW1wbGVtZW50YXRpb24nICsgUCAnQHByb3BlcnR5JyArIFAgJ0BlbmQnCiAgICAgICAgICAgICAgICAgICAgKyBQICdAc2VsZWN0b3InICsgUCAnQHByb3RvY29sJyArIFAgJ0BhdXRvcmVsZWFzZXBvb2wnIAogICAgICAgICAgICAgICAgICAgICsgUCAnQHRyeScgKyBQICdAY2F0Y2gnICsgUCAnQHRocm93JyArIFAgJ0BmaW5hbGx5JwogICAgICAgICAgICAgICAgICAgICsgUCAnI2ltcG9ydCcgKyBQJ0BlbnVtZXJhdGUnICsgUCdAdHlwZWRlZicgKyBQICdAY2xhc3MnCiAgICAgICAgICAgICAgICAgICAgKyBQICdAWycgKyBQICdAeycgKyBQJ1lFUycgKyBQJ05PJwogICAgICAgICAgICAgICAgICAgIAoKbG9jYWwga2V5d29yZCA9IHRva2VuKCdrZXl3b3JkJywgKFAgJ2FuZCcgKyBQICdicmVhaycgKyBQICdkbycgKyBQICdlbHNlaWYnICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFAgJ2Vsc2UnICsgUCAnZW5kJyArIFAgJ2ZhbHNlJyArIFAgJ2ZvcicgKyBQICdmdW5jdGlvbicgKyBQICdpZicgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUCAnaW4nICsgUCAnbG9jYWwnICsgUCAnbmlsJyArIFAgJ25vdCcgKyBQICdvcicgKyBQICdyZXBlYXQnICsgUCAncmV0dXJuJyArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQICd0aGVuJyArIFAgJ3RydWUnICsgUCAndW50aWwnICsgUCAnd2hpbGUnICsgb2x1YV9rZXl3b3JkcyApICogCiAgICAgICAgICAgICAgICAgICAgICAtKGlkc2FmZSArIGRpZ2l0KSkKCi0tIG51bWJlcnMKbG9jYWwgbnVtYmVyX3NpZ24gPSBTJystJ14tMQpsb2NhbCBudW1iZXJfZGVjaW1hbCA9IGRpZ2l0IF4gMQpsb2NhbCBudW1iZXJfaGV4YWRlY2ltYWwgPSBQICcwJyAqIFMgJ3hYJyAqIFIoJzA5JywgJ0FGJywgJ2FmJykgXiAxCmxvY2FsIG51bWJlcl9mbG9hdCA9IChkaWdpdF4xICogUCcuJyAqIGRpZ2l0XjAgKyBQJy4nICogZGlnaXReMSkgKiAoUydlRScgKiBudW1iZXJfc2lnbiAqIGRpZ2l0XjEpXi0xCmxvY2FsIG51bWJlcl9pbl9sdWEgPSBudW1iZXJfaGV4YWRlY2ltYWwgKyBudW1iZXJfZmxvYXQgKyBudW1iZXJfZGVjaW1hbApsb2NhbCBvbHVhX251bWJlciA9IFAgJ0AnICogbnVtYmVyX2luX2x1YQpsb2NhbCBudW1iZXIgPSB0b2tlbignbnVtYmVyJywgbnVtYmVyX2luX2x1YSArIG9sdWFfbnVtYmVyKQoKLS0gY2FsbGJhY2sgZm9yIFs9WyBsb25nIHN0cmluZ3MgXT1dCgpsb2NhbCBsb25nc3RyaW5ncHJlZGljYXRlID0gUChmdW5jdGlvbihpbnB1dCwgaW5kZXgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGxldmVsID0gaW5wdXQ6bWF0Y2goJ14lWyg9KiklWycsIGluZGV4KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBsZXZlbCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBfLCBzdG9wID0gaW5wdXQ6ZmluZCgnXScgLi4gbGV2ZWwgLi4gJ10nLCBpbmRleCwgdHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHN0b3AgdGhlbiByZXR1cm4gc3RvcCArIDEgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpCgpsb2NhbCBsb25nc3RyaW5nID0gIyhQJ1snICogUCc9J14xICogUCdbJykgKiBsb25nc3RyaW5ncHJlZGljYXRlCgotLSBzdHJpbmdzCmxvY2FsIHNpbmdsZV91dGY4ID0gKCgxIC0gUyAiJ1xyXG5cZlxcIikgKyAoUCAnXFwnICogMSkpCmxvY2FsIGRvdWJsZV91dGY4ID0gKCgxIC0gUyAnIlxyXG5cZlxcJykgKyAoUCAnXFwnICogMSkpCmxvY2FsIHNpbmdsZXF1b3RlZF9zdHJpbmcgPSBQICInIiAqIHNpbmdsZV91dGY4IF4gMCAqICInIgpsb2NhbCBkb3VibGVxdW90ZWRfc3RyaW5nID0gUCAnIicgKiBkb3VibGVfdXRmOCBeIDAgKiAnIicKbG9jYWwgb2x1YV9zaW5nbGVxdW90ZWRfc3RyaW5nID0gUCAiQCciICogc2luZ2xlX3V0ZjggXiAwICogIiciCmxvY2FsIG9sdWFfZG91YmxlcXVvdGVkX3N0cmluZyA9IFAgJ0AiJyAqIGRvdWJsZV91dGY4IF4gMCAqICciJwpsb2NhbCBsdWFfc3RyaW5nID0gdG9rZW4oJ3N0cmluZycsIHNpbmdsZXF1b3RlZF9zdHJpbmcgKyBkb3VibGVxdW90ZWRfc3RyaW5nICsgbG9uZ3N0cmluZyArIG9sdWFfc2luZ2xlcXVvdGVkX3N0cmluZyArIG9sdWFfZG91YmxlcXVvdGVkX3N0cmluZykKCi0tIGNvbW1lbnRzCmxvY2FsIHNpbmdsZWxpbmVfY29tbWVudCA9IFAgJy0tJyAqICgxIC0gUyAnXHJcblxmJykgXiAwCmxvY2FsIG11bHRpbGluZV9jb21tZW50ID0gUCAnLS0nICogKCMoUCdbJyAqIFAnPSdeMCAqIFAnWycpICogbG9uZ3N0cmluZ3ByZWRpY2F0ZSkKbG9jYWwgb2x1YV9zaW5nbGVsaW5lX2NvbW1lbnQgPSBQICcvLycgKiAoIDEgLSBTICdcclxuXGYnKSBeIDAKbG9jYWwgb2x1YV9tdWx0aWxpbmVfY29tbWVudCA9IFAgJy8qJyAqIGxvbmdzdHJpbmdwcmVkaWNhdGUgKiBQICcqLycKbG9jYWwgY29tbWVudCA9IHRva2VuKCdjb21tZW50JywgbXVsdGlsaW5lX2NvbW1lbnQgKyBzaW5nbGVsaW5lX2NvbW1lbnQgKyBvbHVhX3NpbmdsZWxpbmVfY29tbWVudCkKCi0tIHdoaXRlc3BhY2UKbG9jYWwgd2hpdGVzcGFjZSA9IHRva2VuKCd3aGl0ZXNwYWNlJywgUygnXHJcblxmXHQgJyleMSkKCi0tIG9yZGVyZWQgY2hvaWNlIG9mIGFsbCB0b2tlbnMgYW5kIGxhc3QtcmVzb3J0IGVycm9yIHdoaWNoIGNvbnN1bWVzIG9uZSBjaGFyYWN0ZXIKbG9jYWwgYW55X3Rva2VuID0gd2hpdGVzcGFjZSArIG51bWJlciArIGtleXdvcmQgKyBpZGVudCArCmx1YV9zdHJpbmcgKyBjb21tZW50ICsgb3BlcmF0b3IgKyB0b2tlbignZXJyb3InLCAxKQoKLS0gcHJpdmF0ZSBpbnRlcmZhY2UKbG9jYWwgdGFibGVfb2ZfdG9rZW5zID0gQ3QoYW55X3Rva2VuIF4gMCkKCi0tIGluY3JlbWVudCBbbGluZV0gYnkgdGhlIG51bWJlciBvZiBsaW5lLWVuZHMgaW4gW3RleHRdCmxvY2FsIGZ1bmN0aW9uIHN5bmMobGluZSwgdGV4dCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBpbmRleCwgbGltaXQgPSAxLCAjdGV4dAogICAgICAgICAgICAgICAgICAgIHdoaWxlIGluZGV4IDw9IGxpbWl0IGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHN0YXJ0LCBzdG9wID0gdGV4dDpmaW5kKCdcclxuJywgaW5kZXgsIHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzdGFydCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydCwgc3RvcCA9IHRleHQ6ZmluZCgnW1xyXG5cZl0nLCBpbmRleCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzdGFydCB0aGVuIGJyZWFrIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBzdG9wICsgMQogICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZSArIDEKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZQogICAgICAgICAgICAgICAgZW5kCgotLSB3ZSBvbmx5IG5lZWQgdG8gc3luY2hyb25pemUgdGhlIGxpbmUtY291bnRlciBmb3IgdGhlc2UgdG9rZW4gdHlwZXMKbG9jYWwgbXVsdGlsaW5lX3Rva2VucyA9IHsgY29tbWVudCA9IHRydWUsIHN0cmluZyA9IHRydWUsIHdoaXRlc3BhY2UgPSB0cnVlIH0KCi0tIHB1YmxpYyBpbnRlcmZhY2UKZnVuY3Rpb24gZ2V0cmF3dG9rZW5zKGlucHV0KQogICAgICAgICAgICAgICAgYXNzZXJ0KHR5cGUoaW5wdXQpID09ICdzdHJpbmcnLCAnYmFkIGFyZ3VtZW50ICMxIChleHBlY3RlZCBzdHJpbmcpJykKICAgICAgICAgICAgICAgIGxvY2FsIGxpbmUgPSAxCiAgICAgICAgICAgICAgICBsb2NhbCB0b2tlbnMgPSBscGVnLm1hdGNoKHRhYmxlX29mX3Rva2VucywgaW5wdXQpCiAgICAgICAgICAgICAgICBmb3IgaSwgdG9rZW4gaW4gcGFpcnModG9rZW5zKSBkbwogICAgICAgICAgICAgICAgICAgIHRva2VuWzNdID0gbGluZQogICAgICAgICAgICAgICAgICAgIGlmIG11bHRpbGluZV90b2tlbnNbdG9rZW5bMV1dIHRoZW4gCiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgPSBzeW5jKGxpbmUsIHRva2VuWzJdKSAKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgcmV0dXJuIHRva2VucwogICAgICAgICBlbmQKCmZ1bmN0aW9uIGdldHRva2VucyggaW5wdXQpCiAgICAgICAgICAgIGxvY2FsIHJhd3Rva2VucyA9IGdldHJhd3Rva2VucyhpbnB1dCkKICAgICAgICAgICAgbG9jYWwgdG9rZW5zID0ge30KCiAgICAgICAgICAgIGxvY2FsIGxhc3RyYXd0b2tlbiA9IG5pbAoKICAgICAgICAgICAgbG9jYWwgZnVuY3Rpb24gcHVzaHRva2VuKHJhd3Rva2VuKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxhc3RyYXd0b2tlbiBhbmQgKGxhc3RyYXd0b2tlblsxXSB+PSAnd2hpdGVzcGFjZScpIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChsYXN0cmF3dG9rZW5bMV0gfj0gJ2NvbW1lbnQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHQgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gbGFzdHJhd3Rva2VuWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IGxhc3RyYXd0b2tlblsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgPSBsYXN0cmF3dG9rZW5bM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBubGFmdGVyID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLURlYWwgb2x1YV9zdHJpbmcqIGhlcmUsIGp1c3QgcmVtb3ZlIHRoZSBgQCcsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLXRyZWF0IGl0IGFzIG5vcm1hbCBsdWEgc3RyaW5nIChgQCcgPT0gNjQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ3N0cmluZycpIGFuZCAodC50ZXh0OmJ5dGUoMSkgPT0gNjQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudGV4dCA9IHQudGV4dDpzdWIoMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudHlwZSA9ICdOU0NvbnN0YW50U3RyaW5nJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ251bWJlcicpIGFuZCAodC50ZXh0OmJ5dGUoMSkgPT0gNjQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudGV4dCA9IHQudGV4dDpzdWIoMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudHlwZSA9ICdOU0NvbnN0YW50TnVtYmVyJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ2lkZW50aWZpZXInKSBhbmQgKHQudGV4dCA9PSAnX19MSU5FX18nKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnR5cGUgPSAnbnVtYmVyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC50ZXh0ID0gcmF3dG9rZW5bM10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ2tleXdvcmQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC50ZXh0ID09ICdZRVMnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC50ZXh0ID0gJ3RydWUnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAnTk8nKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC50ZXh0ID0gJ05PJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSAnb3BlcmF0b3InKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC50ZXh0ID09ICchPScpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnRleHQgPSAnfj0nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiByYXd0b2tlbiBhbmQgcmF3dG9rZW5bMl06ZmluZCgnXG4nKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm5sYWZ0ZXIgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zWyN0b2tlbnMrMV0gPSB0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RyYXd0b2tlbiA9IHJhd3Rva2VuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGZvciBfLCByYXd0b2tlbiBpbiBpcGFpcnMocmF3dG9rZW5zKSBkbwogICAgICAgICAgICAgICAgcHVzaHRva2VuKHJhd3Rva2VuKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIHB1c2h0b2tlbihuaWwpCgogICAgICAgICAgICByZXR1cm4gdG9rZW5zCiAgICAgICAgZW5kCgpsb2NhbCBmdW5jdGlvbiBzdHJpbmdpZnkocykKICAgICAgICAgICAgICAgICAgICBpZiBub3QgczpmaW5kKCInIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyInLi5zLi4nIicKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgbm90IHM6ZmluZCgiJyIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICInIi4ucy4uIiciCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGkgPSAwCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBlID0gc3RyaW5nLnJlcCgnPScsIGkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzOmZpbmQoIiVbIi4uZS4uIiVdIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdbJy4uZS4uJ1snLi5zLi4nXScuLmUuLiddJwogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGkgKyAxCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKCmxvY2FsIGZ1bmN0aW9uIGxlYWYodCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3R5cGU9ImxlYWYiLCB2YWx1ZT10fQogICAgICAgICAgICAgICAgZW5kCgpsb2NhbCBmdW5jdGlvbiBpZGVudGlmaWVybGVhZihzKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBsZWFmKHt0eXBlPSdpZGVudGlmaWVyJywgdGV4dD1zfSkKICAgICAgICAgICAgICAgZW5kCgpsb2NhbCBmdW5jdGlvbiBzdHJpbmdsZWFmKHMpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxlYWYoe3R5cGU9J3N0cmluZycsIHRleHQ9c3RyaW5naWZ5KHMpfSkKICAgICAgICAgICAgICAgIGVuZAoKZnVuY3Rpb24gbWV0aG9kY2FsbChhc3QpCiAgICAgICAgICAgIGxvY2FsIG9iamVjdCA9IGFzdC5vYmplY3QKICAgICAgICAgICAgbG9jYWwgc2VsZWN0b3IgPSBhc3Quc2VsZWN0b3IKICAgICAgICAgICAgbG9jYWwgYXJncyA9IGFzdC5hcmdzCgogICAgICAgICAgICBpZiBvYmplY3QgdGhlbgogICAgICAgICAgICAgICAgLS0gTm9ybWFsIG1ldGhvZCBjYWxsLgogICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHR5cGU9Im9sdWFfbWV0aG9kX2lubmVyX2NhbGwiLAogICAgICAgICAgICAgICAgICAgIG9iamVjdD1vYmplY3QsCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3I9c3RyaW5naWZ5KHNlbGVjdG9yKSwKICAgICAgICAgICAgICAgICAgICBhcmdzPQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0nbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHVucGFjayhhcmdzKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgLS0gc3VwZXIgY2FsbC4KICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0eXBlPSJvbHVhX21ldGhvZF9zdXBlcl9jYWxsIiwKICAgICAgICAgICAgICAgICAgICBhcmdzPQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0nbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ2xlYWYoc2VsZWN0b3IpLAogICAgICAgICAgICAgICAgICAgICAgICB1bnBhY2soYXJncykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKbG9jYWwgZnVuY3Rpb24gbWV0aG9kZGVmaW5pdGlvbihhc3QsIGNsYXNzLCBtZXRob2RUeXBlKQogICAgICAgICAgICAtLWltcGxpY2l0ICdzZWxmJyBhcmd1bWVudCBmb3IgY2xhc3MgbWV0aG9kCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7bGVhZigic2VsZiIpLCBsZWFmKCJfY21kIil9CiAgICAgICAgICAgIGlmIGFzdC5hcmdzIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIGlwYWlycyhhc3QuYXJncykgZG8KICAgICAgICAgICAgICAgICAgICBhcmdzWyNhcmdzKzFdID0gdgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpZiBhc3QuZXh0cmFhcmdzIHRoZW4KICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIGlwYWlycyhhc3QuZXh0cmFhcmdzKSBkbwogICAgICAgICAgICAgICAgICAgIGFyZ3NbI2FyZ3MrMV0gPSB2CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCgogICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHlwZT0ibHVhQ2xhc3NfYWRkTWV0aG9kIiwKICAgICAgICAgICAgICAgIG1ldGhvZFR5cGU9bWV0aG9kVHlwZSwKICAgICAgICAgICAgICAgIGNsYXNzPSBjbGFzcywKICAgICAgICAgICAgICAgIHNlbGVjdG9yPSBzdHJpbmdpZnkoYXN0LnNlbGVjdG9yKSwKICAgICAgICAgICAgICAgIGFyZ3R5cGVzPSBhc3QuYXJndHlwZXMsCiAgICAgICAgICAgICAgICByZXR0eXBlPWFzdC5yZXR0eXBlLAogICAgICAgICAgICAgICAgaW1wPQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHR5cGU9ImZ1bmN0aW9uZGVmIiwKICAgICAgICAgICAgICAgICAgICBhcmdzPQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0nbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHVucGFjayhhcmdzKQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgY2h1bms9YXN0LmNodW5rCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBlbmQKCmZ1bmN0aW9uIGltcGxlbWVudGF0aW9uKGFzdCkKICAgIGxvY2FsIGNhdGVnb3J5ID0gaWRlbnRpZmllcmxlYWYoIm5pbCIpCiAgICBpZiBhc3QuY2F0ZWdvcnkgdGhlbgogICAgICAgIGNhdGVnb3J5ID0gc3RyaW5nbGVhZihhc3QuY2F0ZWdvcnkudGV4dCkKICAgIGVuZAoKICAgIGxvY2FsIG5ld2FzdCA9IAogICAgewogICAgICAgIHR5cGU9ImNsYXNzX2ltcGxlbWVudGF0aW9uIiwKICAgICAgICBjbGFzcz1hc3QuY2xhc3MsCiAgICAgICAgY2h1bms9CiAgICAgICAgewogICAgICAgICAgICB0eXBlPSJjaHVuayIKICAgICAgICB9LAogICAgICAgIGNsYXNzTWV0aG9kc0NodW5rPQogICAgICAgIHsKICAgICAgICAgICAgdHlwZT0iY2h1bmsiCiAgICAgICAgfSwKICAgIH0KCiAgICAtLSBFbWl0IGNvZGUgdG8gY3JlYXRlIHRoZSBzdWJjbGFzcywgaWYgbmVjZXNzYXJ5LgoKICAgIGlmIGFzdC5zdXBlcmNsYXNzIHRoZW4KICAgICAgICBuZXdhc3QuY2h1bmtbI25ld2FzdC5jaHVuaysxXSA9IHsKICAgICAgICAgICAgdHlwZT0iYXNzaWdubWVudCIsCiAgICAgICAgICAgIGxlZnQ9bGVhZihhc3QuY2xhc3MpLAogICAgICAgICAgICByaWdodD0KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHlwZT0ib2JqY19hbGxvY2F0ZUNsYXNzUGFpciIsCiAgICAgICAgICAgICAgICBhcmdzPQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHR5cGU9J2xpc3QnLAogICAgICAgICAgICAgICAgICAgIHN0cmluZ2xlYWYoYXN0LmNsYXNzLnRleHQpLAogICAgICAgICAgICAgICAgICAgIHN0cmluZ2xlYWYoYXN0LnN1cGVyY2xhc3MpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICBlbmQKCi0tIENvbGxlY3QgdGhlIGNvbnRlbnRzIG9mIHRoZSBpbXBsZW1lbnRhdGlvbiBjaHVuayBpbnRvIGxvY2FsIGRlZmluaXRpb25zLAotLSBvYmplY3QgbWV0aG9kcyBhbmQgY2xhc3MgbWV0aG9kcy4gQWxzbyBjb25zdHJ1Y3QgdGhlIG1ldGFkYXRhIHRhYmxlLgoKICAgIGxvY2FsIGxvY2FscyA9IHt9CiAgICBsb2NhbCBvYmplY3RtZXRob2RzID0ge30KICAgIGxvY2FsIGNsYXNzbWV0aG9kcyA9IHt9CiAgICBsb2NhbCBtZXRhZGF0YSA9IHt9CiAgICBmb3IgXywgayBpbiBpcGFpcnMoYXN0KSBkbwogICAgICAgIGlmIChrLnR5cGUgPT0gIm9sdWFfbWV0aG9kZGVmaW5pdGlvbiIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgbSA9IHt9CiAgICAgICAgICAgIGxvY2FsIHMKICAgICAgICAgICAgaWYgay5jbGFzc21ldGhvZCB0aGVuCiAgICAgICAgICAgICAgICBjbGFzc21ldGhvZHNbI2NsYXNzbWV0aG9kcyArIDFdID0gawogICAgICAgICAgICAgICAgcyA9ICIrIiAuLiBrLnNlbGVjdG9yCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG9iamVjdG1ldGhvZHNbI29iamVjdG1ldGhvZHMgKyAxXSA9IGsKICAgICAgICAgICAgICAgIHMgPSAiLSIgLi4gay5zZWxlY3RvcgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgbS5hcmd0eXBlcyA9IGsuYXJndHlwZXMKICAgICAgICAgICAgbS5yZXR0eXBlID0gay5yZXR0eXBlCiAgICAgICAgICAgIG1ldGFkYXRhW3NdID0gbQogICAgICAgIGVsc2UKICAgICAgICAgICAgbG9jYWxzWyNsb2NhbHMgKyAxXSA9IGsKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGlmICgjb2JqZWN0bWV0aG9kcyA9PSAwKSBhbmQgKCNjbGFzc21ldGhvZHMgPT0gMCkgdGhlbgogICAgICAgIHJldHVybiBuZXdhc3QKICAgIGVuZAoKICAgIC0tIEVtaXQgY2F0ZWdvcnkgdGVtcGxhdGUuCgogICAgbG9jYWwgY2h1bmsgPSB7dHlwZT0iY2h1bmsifQogICAgZm9yIF8sIGsgaW4gaXBhaXJzKGxvY2FscykgZG8KICAgICAgICBjaHVua1sjY2h1bmsrMV0gPSBrCiAgICBlbmQKCiAgICBsb2NhbCBjbGFzc01ldGhvZHNDaHVuayA9IHt0eXBlPSJjaHVuayJ9CiAgICBmb3IgXywgayBpbiBpcGFpcnMoY2xhc3NtZXRob2RzKSBkbwogICAgICAgIGNsYXNzTWV0aG9kc0NodW5rWyNjbGFzc01ldGhvZHNDaHVuaysxXSA9IG1ldGhvZGRlZmluaXRpb24oaywgYXN0LmNsYXNzLCAiY2xhc3NtZXRob2QiKQogICAgZW5kCgogICAgbmV3YXN0LmNsYXNzTWV0aG9kc0NodW5rWyNuZXdhc3QuY2xhc3NNZXRob2RzQ2h1bmsrMV0gPSAgICAgCiAgICB7ICAgCiAgICAgICAgdHlwZT0ib2x1YV9jbGFzc19tZXRob2RfaW1wbGVtZW50YXRpb24iLAogICAgICAgIGNodW5rID0gY2xhc3NNZXRob2RzQ2h1bmssCiAgICB9CgogICAgZm9yIF8sIGsgaW4gaXBhaXJzKG9iamVjdG1ldGhvZHMpIGRvCiAgICAgICAgY2h1bmtbI2NodW5rKzFdID0gbWV0aG9kZGVmaW5pdGlvbihrLCBhc3QuY2xhc3MsICJvYmplY3RtZXRob2QiKQogICAgZW5kCgogICAgbmV3YXN0LmNodW5rWyNuZXdhc3QuY2h1bmsrMV0gPSAgICAgCiAgICB7ICAgCiAgICAgICAgdHlwZT0ib2x1YV9jbGFzc19tZXRob2RfaW1wbGVtZW50YXRpb24iLAogICAgICAgIGNodW5rID0gY2h1bmssCiAgICB9CiAgICByZXR1cm4gbmV3YXN0CmVuZAoKCmxvY2FsIHNvdXJjZQpsb2NhbCB0b2tlbnMKbG9jYWwgcG9zCgpsb2NhbCBwZWVrCmxvY2FsIGV4cGVjdApsb2NhbCBvcHRpb25hbGV4cGVjdAoKbG9jYWwgY2h1bmsKbG9jYWwgc3RhdApsb2NhbCBsYXN0c3RhdApsb2NhbCBkb2VuZApsb2NhbCBpZmVsc2VlbmQKbG9jYWwgd2hpbGVkb2VuZApsb2NhbCByZXBlYXR1bnRpbApsb2NhbCBmb3JlbmQKbG9jYWwgZnVuY3Rpb25kZWYKbG9jYWwgYXNzaWdubWVudApsb2NhbCBsb2NhbGRlZgpsb2NhbCBydmFsdWVsaXN0CmxvY2FsIHJ2YWx1ZQpsb2NhbCBydmFsdWUyCmxvY2FsIHJ2YWx1ZTMKbG9jYWwgcnZhbHVlNApsb2NhbCBydmFsdWU1CmxvY2FsIHJ2YWx1ZTYKbG9jYWwgcnZhbHVlNwpsb2NhbCBydmFsdWU4CmxvY2FsIHJ2YWx1ZTkKbG9jYWwgcnZhbHVlbGVhZgpsb2NhbCBsdmFsdWVsaXN0CmxvY2FsIGx2YWx1ZQpsb2NhbCBsdmFsdWVsZWFmCmxvY2FsIGx2YWx1ZWlkZW50aWZpZXIKbG9jYWwgZnVuY3Rpb25jYWxsCmxvY2FsIHRhYmxlbGl0ZXJhbAoKbG9jYWwgb2x1YV9tZXRob2RjYWxsCmxvY2FsIG9sdWFfaW1wbGVtZW50YXRpb24KbG9jYWwgb2x1YV90eXBlYW5ub3RhdGlvbgpsb2NhbCBvbHVhX21ldGhvZGRlZmluaXRpb24KbG9jYWwgb2x1YV9jcmVhdGVTZWxlY3Rvcgpsb2NhbCBvbHVhX2dldFByb3RvY29sCmxvY2FsIG9sdWFfaW1wb3J0X2ZpbGUKbG9jYWwgb2x1YV90aHJvdwpsb2NhbCBvbHVhX29iamNfYmxvY2tPYmplY3QKbG9jYWwgb2x1YV9vYmpjX2VudW1lcmF0b3IKbG9jYWwgb2x1YV9vYmpjX2NsYXNzUHJlZGVjbGVhcmF0aW9uCmxvY2FsIG9sdWFfb2JqY19saXRlcmFsQXJyYXkKbG9jYWwgb2x1YV9vYmpjX2xpdGVyYWxEaWN0aW9uYXJ5CgpmdW5jdGlvbiBwYXJzZWVycm9yKG1lc3NhZ2UpCiAgICBsb2NhbCB0ID0gdG9rZW5zW3Bvc10KICAgIGxvY2FsIGxpbmUgPSAidW5rbm93biBsb2NhdGlvbiIKICAgIGlmIHQgYW5kIHQubGluZSB0aGVuCiAgICAgICAgbGluZSA9IHQubGluZQogICAgZW5kCgogICAgZXJyb3IoIlBhcnNlIGVycm9yIGF0ICIuLmxpbmUuLiIgb2YgIi4uc291cmNlLi4iOiAiLi5tZXNzYWdlKQplbmQKCmxvY2FsIGV4cGVjdGVkZXJyb3IgPSBmdW5jdGlvbih0eXBlLCB0ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHt0eXBlPSJlb2YiLCB0ZXh0PSIifQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IHRleHQgb3IgIihhbnl0aGluZykiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWVycm9yKCJleHBlY3RlZCBhICIuLnR5cGUuLiIsICciLi50ZXh0Li4iJywgYnV0IGdvdCBhICIuLnQudHlwZS4uIiwgJyIuLnQudGV4dC4uIiciKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCmxvY2FsIHVuZXhwZWN0ZWRlcnJvciA9IGZ1bmN0aW9uKHRva2VuKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VlcnJvcigidW5leHBlY3RlZCAiLi50b2tlbi50eXBlLi4iLCAnIi4udG9rZW4udGV4dC4uIiciKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCmxvY2FsIHN0YXRlbWVudGVycm9yID0gZnVuY3Rpb24odG9rZW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWVycm9yKCJleHBlY3RlZCBhIHN0YXRlbWVudCwgZ290IGEgIi4udG9rZW4udHlwZS4uIiwgJyIuLnRva2VuLnRleHQuLiInIikKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgpsb2NhbCBpbnRlcm5hbGVycm9yID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VlcnJvcigiaW50ZXJuYWwgZXJyb3IiKQogICAgICAgICAgICAgICAgICAgICAgZW5kCgpwZWVrID0gZnVuY3Rpb24odHlwZSwgLi4uKQogICAgICAgICAgICBsb2NhbCB0ID0gdG9rZW5zW3Bvc10KICAgICAgICAgICAgaWYgbm90IHQgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIG5pbAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIGlmICh0LnR5cGUgfj0gdHlwZSkgdGhlbgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgbG9jYWwgbGlzdCA9IHsuLi59CiAgICAgICAgICAgIGlmICgjbGlzdCA9PSAwKSB0aGVuCiAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgZm9yIF8sIHMgaW4gaXBhaXJzKGxpc3QpIGRvCiAgICAgICAgICAgICAgICBpZiAodC50ZXh0ID09IHMpIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICBlbmQKCm9wdGlvbmFsZXhwZWN0ID0gZnVuY3Rpb24odHlwZSwgLi4uKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5pbAogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBsaXN0ID0gey4uLn0KICAgICAgICAgICAgICAgICAgICBpZiAoI2xpc3QgPT0gMCkgYW5kICh0LnR5cGUgPT0gdHlwZSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGZvciBfLCBzIGluIGlwYWlycyhsaXN0KSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC50ZXh0ID09IHMpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmlsCiAgICAgICAgICAgICAgICBlbmQKCmV4cGVjdCA9IGZ1bmN0aW9uKHR5cGUsIC4uLikKICAgICAgICAgICAgbG9jYWwgdCA9IG9wdGlvbmFsZXhwZWN0KHR5cGUsIC4uLikKICAgICAgICAgICAgaWYgbm90IHQgdGhlbgogICAgICAgICAgICAgICAgZXhwZWN0ZWRlcnJvcih0eXBlLCAuLi4pCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gdAogICAgICAgIGVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCTkYgUFJPUEVSICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCmxvY2FsIGZ1bmN0aW9uIGlzdGVybWluYXRvcmtleXdvcmQocykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHMgPT0gImVuZCIpIG9yIChzID09ICJlbHNlIikgb3IKICAgICAgICAgICAgICAgICAgICAocyA9PSAiZWxzZWlmIikgb3IgKHMgPT0gInVudGlsIikgb3IKICAgICAgICAgICAgICAgICAgICAocyA9PSAnQGVuZCcpIAogICAgICAgICAgICAgICAgZW5kCgpjaHVuayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgYXN0ID0ge3R5cGU9ImNodW5rIn0KCiAgICAgICAgICAgIHdoaWxlIHRva2Vuc1twb3NdIGRvCiAgICAgICAgICAgICAgICBsb2NhbCB0ID0gdG9rZW5zW3Bvc10KICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ2tleXdvcmQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgaXN0ZXJtaW5hdG9ya2V5d29yZCh0LnRleHQpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgaWYgKHQudGV4dCA9PSAicmV0dXJuIikgb3IgKHQudGV4dCA9PSAiYnJlYWsiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGEgPSBsYXN0c3RhdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGFzdFsjYXN0KzFdID0gYQoKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWxleHBlY3QoJ29wZXJhdG9yJywgJzsnKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgbG9jYWwgYSA9IHN0YXQoKQogICAgICAgICAgICAgICAgYXN0WyNhc3QrMV0gPSBhCgogICAgICAgICAgICAgICAgb3B0aW9uYWxleHBlY3QoJ29wZXJhdG9yJywgJzsnKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHJldHVybiBhc3QKICAgICAgICBlbmQKCnN0YXQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICBpZiAodC50eXBlID09ICdrZXl3b3JkJykgdGhlbgogICAgICAgICAgICAgICAgaWYgKHQudGV4dCA9PSAiZG8iKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvZW5kKCkKICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICJ3aGlsZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2hpbGVkb2VuZCgpCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAicmVwZWF0IikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXBlYXR1bnRpbCgpCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiaWYiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlmZWxzZWVuZCgpCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiZm9yIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3JlbmQoKQogICAgICAgICAgICAgICAgZWxzZWlmICh0LnRleHQgPT0gImZ1bmN0aW9uIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbmRlZigpCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAibG9jYWwiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsZGVmKCkKICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICJAaW1wbGVtZW50YXRpb24iKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sdWFfaW1wbGVtZW50YXRpb24oKQogICAgICAgICAgICAgICAgZWxzZWlmICh0LnRleHQgPT0gIkBhdXRvcmVsZWFzZXBvb2wiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iamNfYXV0b3JlbGVhc2Vwb29sKCkKICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICIjaW1wb3J0IikgdGhlbgogICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2x1YV9pbXBvcnRfZmlsZSgpCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiQHRocm93IikgdGhlbgogICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2x1YV90aHJvdygpCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiQHRyeSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sdWFfb2JqY190cnljYXRjaGZpbmFsbHkoKQogICAgICAgICAgICAgICAgZWxzZWlmICh0LnRleHQgPT0gIkBlbnVtZXJhdGUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgIHJldHVybiBvbHVhX29iamNfZW51bWVyYXRvcigpCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiQGNsYXNzIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2x1YV9vYmpjX2NsYXNzUHJlZGVjbGVhcmF0aW9uKCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBzdGF0ZW1lbnRlcnJvcih0KQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGxvY2FsIGUgPSBydmFsdWUoKQogICAgICAgICAgICAgICAgaWYgcGVlaygnb3BlcmF0b3InLCAnLCcpIG9yIHBlZWsoJ29wZXJhdG9yJywgJz0nKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFzc2lnbm1lbnQoZSkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKbGFzdHN0YXQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCB0ID0gdG9rZW5zW3Bvc10KICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ2tleXdvcmQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgKHQudGV4dCA9PSAiYnJlYWsiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt0eXBlPSJicmVhayJ9CiAgICAgICAgICAgICAgICAgICAgZWxzZWlmICh0LnRleHQgPT0gInJldHVybiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQoKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2Vuc1twb3NdLnR5cGUgPT0gJ2tleXdvcmQnKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzdGVybWluYXRvcmtleXdvcmQodG9rZW5zW3Bvc10udGV4dCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHJ2YWx1ZWxpc3QoKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7dHlwZT0icmV0dXJuIiwgdmFsdWU9dmFsdWV9CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHN0YXRlbWVudGVycm9yKHQpCiAgICAgICAgICAgIGVuZAoKZG9lbmQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJkbyIpCiAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICBsb2NhbCBhc3QgPSB7fQogICAgICAgICAgICBpZiB0LnR5cGUgPT0gJ29wZXJhdG9yJyBhbmQgdC50ZXh0ID09ICJ7IiB0aGVuCiAgICAgICAgICAgICAgICBhc3QuY2h1bmsgPSBvbHVhX2Jsb2NrKCkKICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJ3aGlsZSIpCiAgICAgICAgICAgICAgICBhc3QuY29uZGl0aW9uID0gcnZhbHVlKCkgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBhc3QudHlwZT0iZG93aGlsZSIKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYXN0LnR5cGUgPSAiZG9lbmQiCiAgICAgICAgICAgICAgICBhc3QuY2h1bmsgPWNodW5rKCkKICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJlbmQiKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcmV0dXJuIGFzdAogICAgICAgIGVuZAoKaWZlbHNlZW5kID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgZXhwZWN0KCdrZXl3b3JkJywgImlmIikKICAgICAgICAgICAgICAgIGxvY2FsIGFzdCA9IHt0eXBlPSJpZmVsc2VlbmQifQogICAgICAgICAgICAgICAgbG9jYWwgaGFzQnJhY2tldEZsYWcgPSBmYWxzZQogICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvbmRpdGlvbiA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYwogICAgICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgICAgIGlmIHQudHlwZSA9PSAnb3BlcmF0b3InIGFuZCB0LnRleHQgPT0gInsiIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaGFzQnJhY2tldEZsYWcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBvbHVhX2Jsb2NrKCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJ0aGVuIikKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IGNodW5rKCkKICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgYXN0WyNhc3QrMV0gPSB7Y29uZGl0aW9uPWNvbmRpdGlvbiwgY2h1bms9Y30KCiAgICAgICAgICAgICAgICAgICAgdCA9IG9wdGlvbmFsZXhwZWN0KCdrZXl3b3JkJywgImVsc2VpZiIsICJlbHNlIiwgImVuZCIpCiAgICAgICAgICAgICAgICAgICAgaWYgKHQudGV4dCA9PSAiZW5kIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICJlbHNlIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB0ID0gdG9rZW5zW3Bvc10KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdC50eXBlID09ICdvcGVyYXRvcicgYW5kIHQudGV4dCA9PSAieyIgdGhlbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc0JyYWNrZXRGbGFnID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IG9sdWFfYmxvY2soKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IGNodW5rKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJlbmQiKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgYXN0WyNhc3QrMV0gPSB7Y2h1bms9Y30KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgaGFzQnJhY2tldEZsYWcgdGhlbgogICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyAtIDEKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgcmV0dXJuIGFzdAogICAgICAgICAgICBlbmQKCndoaWxlZG9lbmQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAid2hpbGUiKQogICAgICAgICAgICAgICAgbG9jYWwgYyA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxvY2FsIGIKICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgaWYgdC50eXBlID09ICdvcGVyYXRvcicgYW5kIHQudGV4dCA9PSAieyIgdGhlbgogICAgICAgICAgICAgICAgICAgIGIgPSBvbHVhX2Jsb2NrKCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAiZG8iKQogICAgICAgICAgICAgICAgICAgIGIgPSBjaHVuaygpCiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdrZXl3b3JkJywgImVuZCIpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0eXBlPSJ3aGlsZWRvZW5kIiwgCiAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uPWMsIAogICAgICAgICAgICAgICAgICAgIGNodW5rPWIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZW5kCgpyZXBlYXR1bnRpbCA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAicmVwZWF0IikKICAgICAgICAgICAgICAgICAgICBsb2NhbCBiID0gY2h1bmsoKQogICAgICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJ1bnRpbCIpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYyA9IHJ2YWx1ZSgpCgogICAgICAgICAgICAgICAgICAgIHJldHVybiB7dHlwZT0icmVwZWF0dW50aWwiLCBjb25kaXRpb249YywgY2h1bms9Yn0KICAgICAgICAgICAgICAgIGVuZAoKZm9yZW5kID0gZnVuY3Rpb24oKQogICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAiZm9yIikKICAgICAgICAgICAgbG9jYWwgYXN0ID0ge30KCiAgICAgICAgICAgIGlmIHBlZWsoJ29wZXJhdG9yJywgJygnKSB0aGVuCiAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICBhc3QudmFyID0gbHZhbHVlKCkKICAgICAgICAgICAgICAgIGFzdC52YXIgPSBsdmFsdWVsaXN0KGFzdC52YXIpCiAgICAgICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAiaW4iKQogICAgICAgICAgICAgICAgYXN0Lml0ZXJhdG9yID0gcnZhbHVlKCkKICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnKScpCiAgICAgICAgICAgICAgICBhc3QuY2h1bmsgPSBvbHVhX2Jsb2NrKCkKICAgICAgICAgICAgICAgIGFzdC50eXBlID0gIm9sdWFfZm9yaW5lbmQiCiAgICAgICAgICAgIGVsc2UKCiAgICAgICAgICAgICAgICBhc3QudmFyID0gbHZhbHVlKCkKICAgICAgICAgICAgICAgIGlmIHBlZWsoJ29wZXJhdG9yJywgJz0nKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgIGFzdC50eXBlID0gImZvcmVuZCIKCiAgICAgICAgICAgICAgICAgICAgYXN0LmxvdyA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICcsJykKICAgICAgICAgICAgICAgICAgICBhc3QuaGlnaCA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgaWYgcGVlaygnb3BlcmF0b3InLCAnLCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICBhc3Quc3RlcCA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgYXN0LnZhciA9IGx2YWx1ZWxpc3QoYXN0LnZhcikKICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAiaW4iKQogICAgICAgICAgICAgICAgICAgIGFzdC50eXBlID0gImZvcmluZW5kIgoKICAgICAgICAgICAgICAgICAgICBhc3QuaXRlcmF0b3IgPSBydmFsdWUoKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgZXhwZWN0KCdrZXl3b3JkJywgImRvIikKICAgICAgICAgICAgICAgIGFzdC5jaHVuayA9IGNodW5rKCkKICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJlbmQiKSAKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJldHVybiBhc3QKICAgICAgICBlbmQKCmZ1bmN0aW9uZGVmID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgZXhwZWN0KCdrZXl3b3JkJywgImZ1bmN0aW9uIikKICAgICAgICAgICAgICAgIGxvY2FsIG5hbWUKICAgICAgICAgICAgICAgIGlmIG5vdCBwZWVrKCdvcGVyYXRvcicsICcoJykgdGhlbgogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBsdmFsdWUoKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICcoJykKICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSBsdmFsdWVsaXN0KCkKICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnKScpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxvY2FsIGMKICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgaWYgdC50eXBlID09ICdvcGVyYXRvcicgYW5kIHQudGV4dCA9PSAieyIgdGhlbgogICAgICAgICAgICAgICAgICAgIGMgPSBvbHVhX2Jsb2NrKCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBjID0gY2h1bmsoKSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAiZW5kIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHR5cGU9ImZ1bmN0aW9uZGVmIiwgCiAgICAgICAgICAgICAgICAgICAgbmFtZT1uYW1lLCAKICAgICAgICAgICAgICAgICAgICBhcmdzPWFyZ3MsIAogICAgICAgICAgICAgICAgICAgIGNodW5rPWMsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGVuZAoKYXNzaWdubWVudCA9IGZ1bmN0aW9uKGUpCiAgICAgICAgICAgICAgICBpZiBub3QgZSBvciBwZWVrKCdvcGVyYXRvcicsICcsJykgdGhlbgogICAgICAgICAgICAgICAgICAgIGUgPSBsdmFsdWVsaXN0KGUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnPScpCiAgICAgICAgICAgICAgICBsb2NhbCBhID0gcnZhbHVlbGlzdCgpCiAgICAgICAgICAgICAgICByZXR1cm4ge3R5cGU9ImFzc2lnbm1lbnQiLCBsZWZ0PWUsIHJpZ2h0PWF9CiAgICAgICAgICAgIGVuZAoKbG9jYWxkZWYgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBleHBlY3QoJ2tleXdvcmQnLCAibG9jYWwiKQogICAgICAgICAgICAgICAgbG9jYWwgYXN0CiAgICAgICAgICAgICAgICBpZiBwZWVrKCdrZXl3b3JkJywgImZ1bmN0aW9uIikgdGhlbgogICAgICAgICAgICAgICAgICAgIGFzdCA9IGZ1bmN0aW9uZGVmKCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBsb2NhbCBlID0gbHZhbHVlbGlzdCgpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYSA9IG5pbAogICAgICAgICAgICAgICAgaWYgcGVlaygnb3BlcmF0b3InLCAnPScpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgYSA9IHJ2YWx1ZWxpc3QoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgYXN0ID0gCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJhc3NpZ25tZW50IiwgCiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ9ZSwgCiAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0PWEKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICByZXR1cm4gCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdHlwZT0ibG9jYWwiLCAKICAgICAgICAgICAgICAgICAgICB2YWx1ZT1hc3QKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICBlbmQKCnJ2YWx1ZWxpc3QgPSBmdW5jdGlvbihlKQogICAgICAgICAgICAgICAgbG9jYWwgYXN0ID0ge3R5cGU9J2xpc3QnfQogICAgICAgICAgICAgICAgaWYgbm90IGUgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIHBlZWsoJ29wZXJhdG9yJywgJyknKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhc3QKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlID0gcnZhbHVlKCkKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGFzdFsjYXN0KzFdID0gZQogICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBwZWVrKCdvcGVyYXRvcicsICcsJykgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXN0CiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgIGFzdFsjYXN0KzFdID0gcnZhbHVlKCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQJCgpsb2NhbCBmdW5jdGlvbiBsZWZ0YXNzb2NiaW5vcChsZWZ0LCBwcmVjZWRlbmNlLCB0eXBlLCAuLi4pCiAgICAgICAgICAgIGxvY2FsIGUgPSBsZWZ0KCkKICAgICAgICAgICAgaWYgcGVlayh0eXBlLCAuLi4pIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQoKICAgICAgICAgICAgICAgIGxvY2FsIGFzdCA9IHt0eXBlPSJiaW5vcCIsIG9wZXJhdG9yPXQsIHByZWNlZGVuY2U9cHJlY2VkZW5jZSwKICAgICAgICAgICAgICAgICAgICBsZWZ0PWUsIHJpZ2h0PWxlZnQoKX0KICAgICAgICAgICAgICAgIHdoaWxlIHBlZWsodHlwZSwgLi4uKSBkbwogICAgICAgICAgICAgICAgICAgIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKCiAgICAgICAgICAgICAgICAgICAgYXN0ID0ge3R5cGU9ImJpbm9wIiwgb3BlcmF0b3I9dCwgcHJlY2VkZW5jZT1wcmVjZWRlbmNlLAogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0PWFzdCwgcmlnaHQ9bGVmdCgpfQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICByZXR1cm4gYXN0CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiBlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAoKbG9jYWwgZnVuY3Rpb24gcmlnaHRhc3NvY2Jpbm9wKGxlZnQsIHByZWNlZGVuY2UsIHR5cGUsIC4uLikKICAgICAgICAgICAgICAgICAgICBsb2NhbCBlID0gbGVmdCgpCiAgICAgICAgICAgICAgICAgICAgaWYgcGVlayh0eXBlLCAuLi4pIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt0eXBlPSJiaW5vcCIsIG9wZXJhdG9yPXQsIHByZWNlZGVuY2U9cHJlY2VkZW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ9ZSwgcmlnaHQ9cnZhbHVlKCl9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCgotLSBvcgpydmFsdWUgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIHJldHVybiBsZWZ0YXNzb2NiaW5vcChydmFsdWUyLCAxLCAna2V5d29yZCcsICJvciIpCiAgICAgICAgIGVuZAoKLS0gYW5kCnJ2YWx1ZTIgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICByZXR1cm4gbGVmdGFzc29jYmlub3AocnZhbHVlMywgMiwgJ2tleXdvcmQnLCAiYW5kIikKICAgICAgICAgICAgZW5kCgotLSA8ID4gPD0gPj0gfj0gPT0KcnZhbHVlMyA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgcmV0dXJuIGxlZnRhc3NvY2Jpbm9wKHJ2YWx1ZTQsIDMsICdvcGVyYXRvcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPCIsICI+IiwgIjw9IiwgIj49IiwgIn49IiwgIj09IiwgIiE9IikKICAgICAgICAgICAgZW5kCgotLSAuLgpydmFsdWU0ID0gZnVuY3Rpb24oKQogICAgICAgICAgICByZXR1cm4gcmlnaHRhc3NvY2Jpbm9wKHJ2YWx1ZTUsIDQsICdvcGVyYXRvcicsICIuLiIpCiAgICAgICAgICBlbmQKCi0tICsgLQpydmFsdWU1ID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgcmV0dXJuIGxlZnRhc3NvY2Jpbm9wKHJ2YWx1ZTYsIDUsICdvcGVyYXRvcicsICIrIiwgIi0iKQogICAgICAgICAgZW5kCgotLSAqIC8gJQpydmFsdWU2ID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgcmV0dXJuIGxlZnRhc3NvY2Jpbm9wKHJ2YWx1ZTcsIDYsICdvcGVyYXRvcicsICIqIiwgIi8iLCAiJSIpCiAgICAgICAgICBlbmQKCi0tIG5vdCAjIHVuYXJ5LQpydmFsdWU3ID0gZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBwZWVrKCdvcGVyYXRvcicsICItIikgb3IgCiAgICAgICAgICAgICAgIHBlZWsoJ29wZXJhdG9yJywgIiMiKSBvcgogICAgICAgICAgICAgICBwZWVrKCdrZXl3b3JkJywgIm5vdCIpIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgcmV0dXJuIHt0eXBlPSJ1bm9wIiwgcHJlY2VkZW5jZT03LCBvcGVyYXRvcj10LnRleHQsIHZhbHVlPXJ2YWx1ZTgoKX0KICAgICAgICAgICAgZW5kCgogICAgICAgICAgICByZXR1cm4gcnZhbHVlOCgpCiAgICAgICAgICBlbmQKCi0tIF4KcnZhbHVlOCA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgcmV0dXJuIHJpZ2h0YXNzb2NiaW5vcChydmFsdWU5LCA4LCAnb3BlcmF0b3InLCAiXiIpCiAgICAgICAgICBlbmQKCi0tIC4gOiBbXSBmdW5jdGlvbmNhbGxzCnJ2YWx1ZTkgPSBmdW5jdGlvbigpCiAgICAgICAgICAgIGxvY2FsIGUgPSBydmFsdWVsZWFmKCkKICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICBpZiBub3QgdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ29wZXJhdG9yJykgdGhlbgkJCiAgICAgICAgICAgICAgICAgICAgaWYgKHQudGV4dCA9PSAiLiIpIG9yICh0LnRleHQgPT0gIjoiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgcmxlYWYgPSBydmFsdWVsZWFmKCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSAKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0iYmlub3AiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdG9yPXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVjZWRlbmNlPTksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdD1lLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0PXJsZWFmCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAnWycpIHRoZW4KICAgICAgICAgICAgICAgICAgICAtLSBUaGlzIG1pZ2h0IGJlIGVpdGhlciBhIGRlcmVmZXJlbmNlIG9yIHRoZSBiZWdpbm5pbmcgb2YgYW4KICAgICAgICAgICAgICAgICAgICAtLSBPYmplY3RpdmUgTHVhIG1ldGhvZCBjYWxsIGluIHRoZSBuZXh0IHN0YXRlbWVudDsgc28gd2UKICAgICAgICAgICAgICAgICAgICAtLSBuZWVkIHRvIGRpc2FtYmlndWF0ZSBhbmQgcG90ZW50aWFsbHkgYmFja3RyYWNrLgogICAgICAgICAgICAgICAgICAgIC0tCiAgICAgICAgICAgICAgICAgICAgLS0gSXQgaXMgYWxsIHJpZ2h0IGZvciBydmFsdWUoKSB0byBiYWlsIHdpdGggYW4gZXJyb3IgYmVjYXVzZQogICAgICAgICAgICAgICAgICAgIC0tIG1ldGhvZCBjYWxscyBzdGFydCB3aXRoIGFuIHJ2YWx1ZSBhcyB3ZWxsLiBJdCBiZSBuaWNlIHRvCiAgICAgICAgICAgICAgICAgICAgLS0gYXZvaWQgcGFyc2luZyB0aGUgcnZhbHVlIHR3aWNlLCBidXQgaXQgZG9lcyBubyBoYXJtLgoKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgb2xkcG9zID0gcG9zCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgaW5kZXggPSBydmFsdWUoKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBvcHRpb25hbGV4cGVjdCgnb3BlcmF0b3InLCAnXScpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIERlcmVmZXJlbmNlLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHt0eXBlPSJkZXJlZiIsIGxlZnQ9ZSwgcmlnaHQ9aW5kZXh9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgLS0gTWV0aG9kIGNhbGwuIEJhY2t0cmFjay4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IG9sZHBvcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmICh0LnRleHQgPT0gJygnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBmdW5jdGlvbmNhbGwoZSkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudHlwZSA9PSAnc3RyaW5nJykgdGhlbgogICAgICAgICAgICAgICAgICAgIGUgPSBmdW5jdGlvbmNhbGwoZSkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgcmV0dXJuIGUKICAgICAgICBlbmQKCmxvY2FsIGZ1bmN0aW9uIGxlYWYodCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3R5cGU9ImxlYWYiLCB2YWx1ZT10fQogICAgICAgICAgICAgICAgZW5kCgpydmFsdWVsZWFmID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICBpZiAodC50eXBlID09ICdrZXl3b3JkJykgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmICh0LnRleHQgPT0gIm5pbCIpIG9yICh0LnRleHQgPT0gInRydWUiKSBvciAodC50ZXh0ID09ICJmYWxzZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGVhZih0KQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICJmdW5jdGlvbiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uZGVmKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiQHNlbGVjdG9yIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvbHVhX2NyZWF0ZVNlbGVjdG9yKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiQHByb3RvY29sIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvbHVhX2dldFByb3RvY29sKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiI2ltcG9ydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2x1YV9pbXBvcnRfZmlsZSgpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmICh0LnRleHQgPT0gIkBlbnVtZXJhdGUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sdWFfb2JqY19lbnVtZXJhdG9yKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAiQFsiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sdWFfb2JqY19saXRlcmFsQXJyYXkoKQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICJAeyIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2x1YV9vYmpjX2xpdGVyYWxEaWN0aW9uYXJ5KCkKICAgICAgICAgICAgICAgICAgICBlbmQgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudHlwZSA9PSAnbnVtYmVyJykgb3IgKHQudHlwZSA9PSAnc3RyaW5nJykgb3IgKHQudHlwZSA9PSAnaWRlbnRpZmllcicpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxlYWYodCkKICAgICAgICAgICAgICAgIGVsc2VpZiAodC50eXBlID09ICdvcGVyYXRvcicpIHRoZW4KICAgICAgICAgICAgICAgICAgICBpZiAodC50ZXh0ID09ICcoJykgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGUgPSBydmFsdWUoKQogICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJyknKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICJ7IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFibGVsaXRlcmFsKCkKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAnWycpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sdWFfbWV0aG9kY2FsbCgpCiAgICAgICAgICAgICAgICAgICAgZWxzZWlmICh0LnRleHQgPT0gIi4uLiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGVhZih0KQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodC50ZXh0ID09ICJeIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvbHVhX29iamNfYmxvY2tPYmplY3QoKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZWlmICh0LnR5cGUgPT0gJ05TQ29uc3RhbnRTdHJpbmcnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgICAgICBlbHNlaWYgKHQudHlwZSA9PSAiTlNDb25zdGFudE51bWJlciIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgdW5leHBlY3RlZGVycm9yKHQpCiAgICAgICAgICAgIGVuZAoKbHZhbHVlbGlzdCA9IGZ1bmN0aW9uKGUpCiAgICAgICAgICAgICAgICBsb2NhbCBhc3QgPSB7dHlwZT0nbGlzdCd9CiAgICAgICAgICAgICAgICBpZiBub3QgZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgcGVlaygnb3BlcmF0b3InLCAnKScpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFzdAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGUgPSBsdmFsdWUoKQogICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgYXN0WyNhc3QrMV0gPSBlCiAgICAgICAgICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHBlZWsoJ29wZXJhdG9yJywgJywnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhc3QKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgYXN0WyNhc3QrMV0gPSBsdmFsdWUoKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAkKCmx2YWx1ZSA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgbG9jYWwgYXN0ID0gbHZhbHVlbGVhZigpCiAgICAgICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSAnb3BlcmF0b3InKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgaWYgKHQudGV4dCA9PSAiLiIpIG9yICh0LnRleHQgPT0gIjoiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIGFzdCA9IAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJiaW5vcCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I9dC50ZXh0LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWNlZGVuY2U9MSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ9YXN0LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0PWx2YWx1ZWxlYWYoKQogICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHQudGV4dCA9PSAnWycpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBpbmRleCA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnXScpCiAgICAgICAgICAgICAgICAgICAgICAgIGFzdCA9IAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJkZXJlZiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdD1hc3QsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ9aW5kZXgKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZXR1cm4gYXN0CiAgICAgICAgZW5kCgpsdmFsdWVsZWFmID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICBpZiAodC50eXBlID09ICdpZGVudGlmaWVyJykgdGhlbgogICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3R5cGU9ImxlYWYiLCB2YWx1ZT10fQogICAgICAgICAgICAgICAgZWxzZWlmICh0LnR5cGUgPT0gJ29wZXJhdG9yJykgdGhlbgogICAgICAgICAgICAgICAgICAgIGlmICh0LnRleHQgPT0gIi4uLiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGVhZih0KQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBwcmludCgiMTA1NSIpCiAgICAgICAgICAgICAgICB1bmV4cGVjdGVkZXJyb3IodCkJCiAgICAgICAgICAgIGVuZAoKbHZhbHVlaWRlbnRpZmllciA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdCA9IGV4cGVjdCgnaWRlbnRpZmllcicpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsZWFmKHQpCiAgICAgICAgICAgICAgICAgICAgZW5kCgpmdW5jdGlvbmNhbGwgPSBmdW5jdGlvbih2YWx1ZSkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzCgogICAgICAgICAgICAgICAgICAgIGlmIHBlZWsoJ3N0cmluZycpIG9yIHBlZWsoJ29wZXJhdG9yJywgInsiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBydmFsdWVsZWFmKCkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnKCcpCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBydmFsdWVsaXN0KCkKICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICcpJykKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3R5cGU9ImZ1bmN0aW9uY2FsbCIsIHZhbHVlPXZhbHVlLCBhcmdzPWFyZ3N9CiAgICAgICAgICAgICAgICBlbmQKCnRhYmxlbGl0ZXJhbCA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBhc3QgPSB7dHlwZT0idGFibGVsaXRlcmFsIn0KICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgInsiKQogICAgICAgICAgICAgICAgICAgIHdoaWxlIG5vdCBwZWVrKCdvcGVyYXRvcicsICd9JykgZG8gCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGVudHJ5ID0ge30KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2Vuc1twb3NdLnR5cGUgPT0gJ2lkZW50aWZpZXInKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgKHRva2Vuc1twb3MrMV0udHlwZSA9PSAnb3BlcmF0b3InKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgKHRva2Vuc1twb3MrMV0udGV4dCA9PSAnPScpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5LmtleSA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeS52YWx1ZSA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodG9rZW5zW3Bvc10udHlwZSA9PSAnb3BlcmF0b3InKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgKHRva2Vuc1twb3NdLnRleHQgPT0gJ1snKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIERpc2FtYmlndWF0ZSBbZXhwcl09dmFsdWUgZnJvbSBbZXhwciBzZWxlY3Rvcl0uCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgb2xkcG9zID0gcG9zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeS5rZXkgPSBydmFsdWUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICddJykgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFRoaXMgbXVzdCBiZSBhIG1ldGhvZCBjYWxsLiBCYWNrdHJhY2suCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gb2xkcG9zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnkua2V5ID0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnkudmFsdWUgPSBydmFsdWUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIEtleS92YWx1ZSBhc3NpZ25tZW50LiB0aGUgYF0nIGhhcyBiZWVuIGV4cGVjdGVkLCBzbyBub3QgZXhwZWN0IGl0IGFnYWluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICc9JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeS52YWx1ZSA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnkudmFsdWUgPSBydmFsdWUoKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgIGFzdFsjYXN0ICsgMV0gPSBlbnRyeQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb3B0aW9uYWxleHBlY3QoJ29wZXJhdG9yJywgJywnLCAnOycpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnfScpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFzdAogICAgICAgICAgICAgICAgZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSAgICAgICAgICAgICAgICAgICAgICAgIE9CSkVDVElWRSBMVUEgRVhURU5TSU9OUyAgICAgICAgICAgICAgICAgICAgICAtLQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKbG9jYWwgZnVuY3Rpb24gcGVla3NlbGVsKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCB0MSA9IHRva2Vuc1twb3MrMF0KICAgICAgICAgICAgICAgICAgICBsb2NhbCB0MiA9IHRva2Vuc1twb3MrMV0KCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHQxIG9yIG5vdCB0MiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBpc3NlbGVsID0gKCh0MS50eXBlID09ICdpZGVudGlmaWVyJykgb3IgKHQxLnR5cGUgPT0gJ2tleXdvcmQnKSkgCiAgICAgICAgICAgICAgICAgICAgCQkJCWFuZCAodDIudHlwZSA9PSAnb3BlcmF0b3InKSBhbmQgKHQyLnRleHQgPT0gIjoiKQoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZWxlbCwgdDEsIHQyCiAgICAgICAgICAgICAgICBlbmQKCmxvY2FsIGZ1bmN0aW9uIGdldHNlbGVsKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCBiLCB0MSwgdDIgPSBwZWVrc2VsZWwoKQogICAgICAgICAgICAgICAgICAgIGlmIGIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAyCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0MS50ZXh0IC4uICI6IgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHJldHVybiBuaWwKICAgICAgICAgICAgICAgZW5kCgogICAgb2x1YV9ibG9jayA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBsb2NhbCBhc3QgPSB7dHlwZT0iY2h1bmsifQogICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAieyIpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgbm90IHBlZWsoJ29wZXJhdG9yJywgJ30nKSBkbyAKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ2tleXdvcmQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpc3Rlcm1pbmF0b3JrZXl3b3JkKHQudGV4dCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC50ZXh0ID09ICJyZXR1cm4iKSBvciAodC50ZXh0ID09ICJicmVhayIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhID0gbGFzdHN0YXQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzdFsjYXN0KzFdID0gYQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbGV4cGVjdCgnb3BlcmF0b3InLCAnOycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGEgPSBzdGF0KCkKICAgICAgICAgICAgICAgICAgICAgICAgYXN0WyNhc3QrMV0gPSBhCgogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25hbGV4cGVjdCgnb3BlcmF0b3InLCAnOycpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICd9JykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJvbHVhX2Jsb2NrIiwKICAgICAgICAgICAgICAgICAgICAgICAgY2h1bms9YXN0LCAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVuZAoKb2x1YV9tZXRob2RjYWxsID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJ1snKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBvYmplY3QgPSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9wdGlvbmFsZXhwZWN0KCdpZGVudGlmaWVyJywgInN1cGVyIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gcnZhbHVlKCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHNlbGVjdG9yID0ge30KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHt9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgcGVlaygnaWRlbnRpZmllcicpIGFuZCBub3QgcGVlaygna2V5d29yZCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkZXJyb3IoImlkZW50aWZpZXIgb3Igc2VsZWN0b3IgZWxlbWVudCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHBlZWtzZWxlbCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tIFNpbmdsZS1lbGVtZW50IHNlbGVjdG9yLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3JbI3NlbGVjdG9yICsgMV0gPSB0b2tlbnNbcG9zXS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ID0gZ2V0c2VsZWwoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3JbI3NlbGVjdG9yICsgMV0gPSB0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnc1sjYXJncyArIDFdID0gcnZhbHVlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICcsJykgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3NbI2FyZ3MgKyAxXSA9IHJ2YWx1ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICddJykKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ldGhvZGNhbGwgCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9Im9sdWFfbWV0aG9kY2FsbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3Q9b2JqZWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3I9IHRhYmxlLmNvbmNhdChzZWxlY3RvciksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzPWFyZ3MKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIGVuZApvbHVhX3Rocm93ID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgbG9jYWwgb2JqID0gc3RhdCgpCiAgICAgICAgICAgICAgICBvcHRpb25hbGV4cGVjdCgnb3BlcmF0b3InLCAnOycpCiAgICAgICAgICAgICAgICBsb2NhbCBhc3QgPSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0eXBlID0gIm9sdWFfdGhyb3ciLAogICAgICAgICAgICAgICAgICAgIHZhbHVlPW9iaiwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBhc3QKICAgICAgICAgICAgIGVuZApvbHVhX2ltcGxlbWVudGF0aW9uID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdrZXl3b3JkJywgIkBpbXBsZW1lbnRhdGlvbiIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2xhc3MgPSBleHBlY3QoJ2lkZW50aWZpZXInKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgc3VwZXJjbGFzcyA9IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2F0ZWdvcnkgPSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICI6IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1cGVyY2xhc3MgPSBydmFsdWVsZWFmKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiBvcHRpb25hbGV4cGVjdCgnb3BlcmF0b3InLCAnKCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeSA9IGV4cGVjdCgnaWRlbnRpZmllcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICcpJykgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhc3QgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9Im9sdWFfaW1wbGVtZW50YXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPWNsYXNzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1cGVyY2xhc3M9c3VwZXJjbGFzcy52YWx1ZS50ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5PWNhdGVnb3J5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rPWMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSB0b2tlbnNbcG9zXSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ2tleXdvcmQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnRleHQgPT0gJ0BlbmQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYSA9IG9sdWFfaW1wbGVtZW50YXRpb25fc3RhdChjbGFzcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3RbI2FzdCsxXSA9IGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICdAZW5kJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGltcGxlbWVudGF0aW9uKGFzdCkKICAgICAgICAgICAgICAgICAgICBlbmQKb2x1YV9jcmVhdGVTZWxlY3RvciA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnKCcpCiAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBzZWwgPSBnZXRzZWxlbCgpCiAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJyknKQogICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0ib2x1YV9jcmVhdGVTZWxlY3RvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWw9c3RyaW5naWZ5KHNlbCksCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGVuZApvbHVhX2dldFByb3RvY29sID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICcoJykKICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHByb3RvY29sID0gZXhwZWN0KCdpZGVudGlmaWVyJykKICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnKScpCiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gCiAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJvbHVhX2dldFByb3RvY29sIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3RvY29sPXN0cmluZ2lmeShwcm90b2NvbC50ZXh0KSwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgZW5kCgpvbHVhX2ltcG9ydF9maWxlID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBmaWxlTmFtZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBvcHRpb25hbGV4cGVjdCgnb3BlcmF0b3InLCAnKCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gZXhwZWN0KCdzdHJpbmcnKS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21waWxlVGltZUludGVyYWN0aW9uKGdfRW5naW5lLCAnaW1wb3J0JywgZmlsZU5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJyknKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IGV4cGVjdCgnc3RyaW5nJykudGV4dAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9Im9sdWFfaW1wb3J0X2ZpbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWU9ZmlsZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgCmxvY2FsIG9sdWFfZ2V0VHlwZU5hbWUgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0eXBlQ29udGVudCA9ICcnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ2lkZW50aWZpZXInKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlQ29udGVudCA9IHQudGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHQudHlwZSA9PSAnb3BlcmF0b3InIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdC50ZXh0ID09ICIqIiB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgID0gcmVzdWx0IC4uIHQudGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlaWYgdC50ZXh0ID09ICdbJyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ251bWJlcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ10nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IC4uICIqIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgxMzkyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5leHBlY3RlZGVycm9yKHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoMTM5NikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5leHBlY3RlZGVycm9yKHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgIApsb2NhbCBvbHVhX2FyZ3VtZW50TGlzdE9mRnVuY3Rpb24gPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCBhc3QgPSB7fQogICAgICAgICAgICAgICAgbG9jYWwgYXJndW1lbnRUeXBlcyA9IHt0eXBlPSdsaXN0J30KICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3VtZW50TmFtZXMgPSB7dHlwZT0nbGlzdCd9CiAgICAgICAgICAgICAgICBhc3QuYXJndW1lbnRUeXBlcyA9IGFyZ3VtZW50VHlwZXMKICAgICAgICAgICAgICAgIGFzdC5hcmd1bWVudE5hbWVzID0gYXJndW1lbnROYW1lcwoKICAgICAgICAgICAgICAgIGlmIHBlZWsoJ29wZXJhdG9yJywgJyknKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFzdAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBvcHRpb25hbGV4cGVjdCgnaWRlbnRpZmllcicsICJ2b2lkIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhc3QKICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgIGxvY2FsIHR5cGVMb29wZXIgPSBsdmFsdWUoKQogICAgICAgICAgICAgICAgbG9jYWwgbmFtZUxvb3BlciA9IGx2YWx1ZSgpCgogICAgICAgICAgICAgICAgYXJndW1lbnRUeXBlc1sjYXJndW1lbnRUeXBlcysxXSA9IHR5cGVMb29wZXIKICAgICAgICAgICAgICAgIGFyZ3VtZW50TmFtZXNbI2FyZ3VtZW50TmFtZXMrMV0gPSBuYW1lTG9vcGVyCgogICAgICAgICAgICAgICAgaWYgcGVlaygnb3BlcmF0b3InLCAnKScpIHRoZW4KICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXN0CiAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgICAgICAgICAgcHJpbnQodG9rZW5zW3Bvc10udGV4dCkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgcGVlaygnb3BlcmF0b3InLCAnLCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFzdAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICB0eXBlTG9vcGVyID0gbHZhbHVlKCkKICAgICAgICAgICAgICAgICAgICBhcmd1bWVudFR5cGVzWyNhcmd1bWVudFR5cGVzKzFdID0gdHlwZUxvb3BlcgogICAgICAgICAgICAgICAgICAgIG5hbWVMb29wZXIgPSBsdmFsdWUoKQogICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50TmFtZXNbI2FyZ3VtZW50TmFtZXMrMV0gPSBuYW1lTG9vcGVyCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHJldHVybiBhc3QKICAgICAgICAgICAgZW5kCQogICAgICAgICAgICAKb2x1YV9vYmpjX2Jsb2NrT2JqZWN0ID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYmxvY2tCb2R5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLS1vcHRpb25hbCBleHBlY3QgdGhlIHJldHVybiB0eXBlLCBqdXN0IGlnbm9yZSBpdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWxleHBlY3QoJ2lkZW50aWZpZXInKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBlZWsoJ29wZXJhdG9yJywgInsiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tCb2R5ID0gb2x1YV9ibG9jaygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICcoJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzID0gb2x1YV9hcmd1bWVudExpc3RPZkZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJyknKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja0JvZHkgPSBvbHVhX2Jsb2NrKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9Im9sdWFfb2JqY19ibG9ja09iamVjdCIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M9YXJncywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tCb2R5PWJsb2NrQm9keSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kCm9sdWFfb2JqY19lbnVtZXJhdG9yID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICJvbHVhX29iamNfZW51bWVyYXRvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IHJ2YWx1ZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKb2x1YV9vYmpjX2NsYXNzUHJlZGVjbGVhcmF0aW9uID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2xhc3NOYW1lcyA9IGx2YWx1ZWxpc3QoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgI2NsYXNzTmFtZXMgPCAxIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3RlZGVycm9yKCdpZGVudGlmaWVyJywgImNsYXNzIG5hbWVzIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWxleHBlY3QoJ29wZXJhdG9yJywgJzsnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGssIHYgaW4gaXBhaXJzKGNsYXNzTmFtZXMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXN0ID0gdi52YWx1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzdC50eXBlID0gJ3N0cmluZycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3QudGV4dCA9IHN0cmluZ2lmeShhc3QudGV4dCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAib2x1YV9vYmpjX2NsYXNzUHJlZGVjbGVhcmF0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWVzID0gY2xhc3NOYW1lcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kCmxvY2FsIHJ0YWdfcmV0dXJuX2luX2NodW5rID0gZnVuY3Rpb24oY2gpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHR5cGVMb29wZXIKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gaXBhaXJzKGNoKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUxvb3BlciA9IHYudHlwZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVMb29wZXIgPT0gImNodW5rIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBzdGF0TG9vcGVyIGluIGlwYWlycyh2KSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydGFnX3JldHVybl9pbl9jaHVuayhzdGF0TG9vcGVyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZWlmICh0eXBlTG9vcGVyID09ICJpZmVsc2VlbmQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGksIGNvbmRpdGlvbiBpbiBpcGFpcnMoYXN0KSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAxKSBvciBjb25kaXRpb24uY29uZGl0aW9uIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0YWdfcmV0dXJuX2luX2NodW5rKGNvbmRpdGlvbi5jb25kaXRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydGFnX3JldHVybl9pbl9jaHVuayhjb25kaXRpb24uY2h1bmspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHR5cGVMb29wZXIgPT0gImZvcmVuZCIpIG9yICh0eXBlTG9vcGVyID09ICJmb3JpbmVuZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciAodHlwZUxvb3BlciA9PSAid2hpbGVkb2VuZCIpIG9yICh0eXBlTG9vcGVyID09ICJyZXBlYXR1bnRpbCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciAodHlwZUxvb3BlciA9PSAiZG9lbmQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnRhZ19yZXR1cm5faW5fY2h1bmsodi5jaHVuaykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodHlwZUxvb3BlciA9PSAicmV0dXJuIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYudHlwZSA9ICJyZXR1cm5Gcm9tQXV0b3JlbGVhc2VQb29sIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAoKb2JqY19hdXRvcmVsZWFzZXBvb2wgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdrZXl3b3JkJywgIkBhdXRvcmVsZWFzZXBvb2wiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGMgPSBvbHVhX2Jsb2NrKCkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnRhZ19yZXR1cm5faW5fY2h1bmsoYy5jaHVuaykKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJvYmpjX2F1dG9yZWxlYXNlcG9vbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2s9YywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAKb2x1YV9vYmpjX3RyeWNhdGNoZmluYWxseSA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0cnlCbG9jayA9IG9sdWFfYmxvY2soKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgna2V5d29yZCcsICJAY2F0Y2giKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnKCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdGhyb3dlZE9iamVjdCA9IGV4cGVjdCgnaWRlbnRpZmllcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICcpJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaHVuayA9IG9sdWFfYmxvY2soKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjYXRjaEJsb2NrID0geyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmcgPSB0aHJvd2VkT2JqZWN0LnRleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmsgPSBjaHVuaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZmluYWxseUJsb2NrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3B0aW9uYWxleHBlY3QoJ2tleXdvcmQnLCAiQGZpbmFsbHkiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsbHlCbG9jayA9IG9sdWFfYmxvY2soKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9Im9sdWFfb2JqY190cnljYXRjaGZpbmFsbHkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnlCbG9jaz10cnlCbG9jaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2hCbG9jaz1jYXRjaEJsb2NrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGx5QmxvY2s9ZmluYWxseUJsb2NrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZApvbHVhX3Byb3BlcnR5X2RlY2xlYXJhdGlvbiA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBwcm9wZXJ0eUF0dHJpYnV0ZSA9IHt9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBvcHRpb25hbGV4cGVjdCgnb3BlcmF0b3InLCAnKCcpIHRoZW4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0ID0gdG9rZW5zW3Bvc10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRleHQgPSB0LnRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0ID09ICcsJykgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodGV4dCA9PSAnKScpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZWlmICh0ZXh0ID09ICJub25hdG9taWMiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcHJvcGVydHlBdHRyaWJ1dGUuYXRvbWljIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoMTUzMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5leHBlY3RlZGVycm9yKHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUF0dHJpYnV0ZS5hdG9taWMgPSAibm9uYXRvbWljIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlaWYgKHRleHQgPT0gImFzc2lnbiIpIG9yICh0ZXh0ID09ICJjb3B5Iikgb3IgKHRleHQgPT0gInJldGFpbiIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwcm9wZXJ0eUF0dHJpYnV0ZS5vd25lcnNoaXAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgxNTM5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmV4cGVjdGVkZXJyb3IodCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QXR0cmlidXRlLm93bmVyc2hpcCA9IHRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZWlmICh0ZXh0ID09ICJnZXR0ZXIiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcHJvcGVydHlBdHRyaWJ1dGUuZ2V0dGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5leHBlY3RlZGVycm9yKHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnPScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QXR0cmlidXRlLmdldHRlciA9IGV4cGVjdCgnaWRlbnRpZmllcicpLnRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VpZiAodGV4dCA9PSAic2V0dGVyIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHByb3BlcnR5QXR0cmlidXRlLnNldHRlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZXhwZWN0ZWRlcnJvcih0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJz0nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBzZXR0ZXIgPSBleHBlY3QoJ2lkZW50aWZpZXInKS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCI6IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBdHRyaWJ1dGUuc2V0dGVyID0gc2V0dGVyIC4uICI6IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJyknKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0eXBlID0gZXhwZWN0KCdpZGVudGlmaWVyJykudGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG5hbWUgPSBleHBlY3QoJ2lkZW50aWZpZXInKS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUF0dHJpYnV0ZVsidHlwZSJdID0gdHlwZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QXR0cmlidXRlWyJuYW1lIl0gPSBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBdHRyaWJ1dGVbImludGVybmFsTmFtZSJdID0gbmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICc9JykgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUF0dHJpYnV0ZVsiaW50ZXJuYWxOYW1lIl0gPSBleHBlY3QoJ2lkZW50aWZpZXInKS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHByb3BlcnR5QXR0cmlidXRlLmF0b21pYyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QXR0cmlidXRlLmF0b21pYyA9ICJhdG9taWMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHByb3BlcnR5QXR0cmlidXRlLm93bmVyc2hpcCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QXR0cmlidXRlLm93bmVyc2hpcCA9ICJhc3NpZ24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHByb3BlcnR5QXR0cmlidXRlLmdldHRlciB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QXR0cmlidXRlLmdldHRlciA9IG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgcHJvcGVydHlBdHRyaWJ1dGUuc2V0dGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBdHRyaWJ1dGUuc2V0dGVyID0gInNldCIgLi4gbmFtZTpnc3ViKCJeJWwiLCBzdHJpbmcudXBwZXIpIC4uICI6IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICc7JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gIm9sdWFfcHJvcGVydHlfZGVjbGVhcmF0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlPXByb3BlcnR5QXR0cmlidXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKb2x1YV9pbXBsZW1lbnRhdGlvbl9zdGF0ID0gZnVuY3Rpb24oY2xhc3MpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdCA9IHRva2Vuc1twb3NdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSAna2V5d29yZCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudGV4dCA9PSAiQHByb3BlcnR5IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYyA9IG9sdWFfcHJvcGVydHlfZGVjbGVhcmF0aW9uKCkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcyA9IGNsYXNzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gIm9sdWFfcHJvcGVydHlfZGVjbGVhcmF0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlID0gYy5hdHRyaWJ1dGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gJ29wZXJhdG9yJykgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKHQudGV4dCA9PSAiLSIpIG9yICh0LnRleHQgPT0gIisiKSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sdWFfbWV0aG9kZGVmaW5pdGlvbigpCQkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlbWVudGVycm9yKHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCm9sdWFfdHlwZWFubm90YXRpb24gPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnb3BlcmF0b3InLCAnKCcpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJlc3VsdCA9ICcnCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHQgPSB0b2tlbnNbcG9zXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSAnb3BlcmF0b3InIGFuZCB0LnRleHQgPT0gJyknKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgPSBwb3MgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgID0gcmVzdWx0IC4uIHQudGV4dAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICAgICAgICAgIGVuZAoKCm9sdWFfbWV0aG9kZGVmaW5pdGlvbiA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHQgPSBleHBlY3QoJ29wZXJhdG9yJywgIi0iLCAiKyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBjbGFzc21ldGhvZCA9ICh0LnRleHQgPT0gIisiKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHNlbGVjdG9yID0ge30KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3R5cGVzID0ge30KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJldHR5cGUgPSAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYXJncyA9IHt9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBleHRyYWFyZ3MgPSB7fQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBlZWsoJ29wZXJhdG9yJywgJygnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dHlwZSA9IG9sdWFfdHlwZWFubm90YXRpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHBlZWsoJ2lkZW50aWZpZXInKSBhbmQgbm90IHBlZWsoJ2tleXdvcmQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRlcnJvcigiaWRlbnRpZmllciBvciBzZWxlY3RvciBlbGVtZW50IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBwZWVrc2VsZWwoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0gU2luZ2xlLWVsZW1lbnQgc2VsZWN0b3IuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3JbI3NlbGVjdG9yICsgMV0gPSB0b2tlbnNbcG9zXS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zID0gcG9zICsgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGdldHNlbGVsKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yWyNzZWxlY3RvciArIDFdID0gdAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGVlaygnb3BlcmF0b3InLCAnKCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3R5cGVzWyNhcmd0eXBlcyArIDFdID0gb2x1YV90eXBlYW5ub3RhdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3R5cGVzWyNhcmd0eXBlcyArIDFdID0ge30KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzWyNhcmdzICsgMV0gPSBsdmFsdWVpZGVudGlmaWVyKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICcsJykgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhYXJncyA9IGx2YWx1ZWxpc3QoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYyA9IG9sdWFfYmxvY2soKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9Im9sdWFfbWV0aG9kZGVmaW5pdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS1jbGFzcz1jbGFzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rvcj10YWJsZS5jb25jYXQoc2VsZWN0b3IpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M9YXJncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmd0eXBlcz1hcmd0eXBlcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR0eXBlPXJldHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFhcmdzPWV4dHJhYXJncywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc21ldGhvZD1jbGFzc21ldGhvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVuaz1jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKCm9sdWFfb2JqY19saXRlcmFsQXJyYXkgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmdzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgxNzE3KQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICddJykgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KDE3MTkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWxleHBlY3QoJ29wZXJhdG9yJywgJzsnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MgPSB7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICJvbHVhX29iamNfbGl0ZXJhbEFycmF5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IGFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgxNzI3KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IHJ2YWx1ZWxpc3QoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0KCdvcGVyYXRvcicsICddJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICc7JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAib2x1YV9vYmpjX2xpdGVyYWxBcnJheSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IGFyZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVuZApvbHVhX29iamNfbGl0ZXJhbERpY3Rpb25hcnkgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3B0aW9uYWxleHBlY3QoJ29wZXJhdG9yJywgJ30nKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICc7JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAib2x1YV9vYmpjX2xpdGVyYWxEaWN0aW9uYXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleXMgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwga2V5cyA9IHt0eXBlPSdsaXN0J30KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YWx1ZXMgPSB7dHlwZT0nbGlzdCd9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzWyNrZXlzICsgMV0gPSBydmFsdWUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJz0nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbI3ZhbHVlcyArIDFdID0gcnZhbHVlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGVlaygnb3BlcmF0b3InLCAnfScpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcyA9IHBvcyArIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsZXhwZWN0KCdvcGVyYXRvcicsICc7JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAib2x1YV9vYmpjX2xpdGVyYWxEaWN0aW9uYXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXlzID0ga2V5cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB2YWx1ZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlY3QoJ29wZXJhdG9yJywgJywnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKbG9jYWwgcGFyc2VyID0gZnVuY3Rpb24oaW5wdXQsIF9zb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgc291cmNlID0gX3NvdXJjZSBvciAiKHVua25vd24pIgogICAgICAgICAgICAgICAgICAgIHRva2VucyA9IGdldHRva2VucyhpbnB1dCkKICAgICAgICAgICAgICAgICAgICBwb3MgPSAxCgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGMgPSBjaHVuaygpCiAgICAgICAgICAgICAgICAgICAgaWYgdG9rZW5zW3Bvc10gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB1bmV4cGVjdGVkZXJyb3IodG9rZW5zW3Bvc10pCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGMJCiAgICAgICAgICAgICAgICBlbmQKCgpsb2NhbCByZXN1bHQKbG9jYWwgcmVjdXJzaXZlbHl1bnBhcnNlCmxvY2FsIHJlY3Vyc2l2ZWx5dW5wYXJzZWJpbm9wCgpsb2NhbCBmdW5jdGlvbiBlbWl0KHMpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0WyNyZXN1bHQgKyAxXSA9IHMKICAgICAgICAgICAgICAgIGVuZAoKbG9jYWwgdHlwZXRhYmxlID0KewoJY2h1bmsgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgICAgICAgICBmb3IgXywgc3RhdGVtZW50IGluIGlwYWlycyhhc3QpIGRvCiAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKHN0YXRlbWVudCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQsCiAgICAgICAgCiAgICBkb2VuZCA9IGZ1bmN0aW9uKGFzdCkKCQllbWl0KCJcbmRvXG4iKQoJCXJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuY2h1bmspCgkJZW1pdCgiXG5lbmQiKQogICAgZW5kLAogICAgICAgIAogICAgaWZlbHNlZW5kID0gZnVuY3Rpb24oYXN0KQoJCWZvciBpLCBjb25kaXRpb24gaW4gaXBhaXJzKGFzdCkgZG8KCQkJaWYgKGkgPT0gMSkgdGhlbgoJCQkJZW1pdCgiaWYiKQoJCQkJcmVjdXJzaXZlbHl1bnBhcnNlKGNvbmRpdGlvbi5jb25kaXRpb24pCgkJCQllbWl0KCJ0aGVuIikKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgaWYgY29uZGl0aW9uLmNvbmRpdGlvbiB0aGVuCiAgICAgICAgICAgICAgICAgICAgZW1pdCgiZWxzZWlmIikKICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoY29uZGl0aW9uLmNvbmRpdGlvbikKICAgICAgICAgICAgICAgICAgICBlbWl0KCJ0aGVuIikKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBlbWl0KCJlbHNlIikKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoY29uZGl0aW9uLmNodW5rKQogICAgICAgIGVuZAogICAgICAgIGVtaXQoImVuZCIpCiAgICBlbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIGZvcmVuZCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCJmb3IiKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QudmFyKQogICAgICAgIGVtaXQoJz0nKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QubG93KQogICAgICAgIGVtaXQoJywnKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuaGlnaCkKICAgICAgICBpZiBhc3Quc3RlcCB0aGVuCiAgICAgICAgICAgIGVtaXQoJywnKQogICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LnN0ZXApCiAgICAgICAgZW5kCiAgICAgICAgZW1pdCgiZG8iKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuY2h1bmspCiAgICAgICAgZW1pdCgiZW5kIikKICAgIGVuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIGZvcmluZW5kID0gZnVuY3Rpb24oYXN0KQogICAgICAgIGVtaXQoImZvciIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC52YXIpCiAgICAgICAgZW1pdCgiaW4iKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuaXRlcmF0b3IpCiAgICAgICAgZW1pdCgiZG8iKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuY2h1bmspCiAgICAgICAgZW1pdCgiZW5kIikKICAgIGVuZCwKICAgIG9sdWFfZm9yaW5lbmQgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgZW1pdCgiZm9yIikKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LnZhcikKICAgICAgICBlbWl0KCIgaW4gb2JqY19OU0Zhc3RFbnVtZXJhdGUoIikKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0Lml0ZXJhdG9yKQogICAgICAgIGVtaXQoIilkbyIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jaHVuaykKICAgICAgICBlbWl0KCJlbmQiKQogICAgZW5kLAogICAgd2hpbGVkb2VuZCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCJ3aGlsZSIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jb25kaXRpb24pCiAgICAgICAgZW1pdCgiZG8iKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuY2h1bmspCiAgICAgICAgZW1pdCgiZW5kIikKICAgIGVuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBkb3doaWxlID0gZnVuY3Rpb24oYXN0KQogICAgICAgIGVtaXQoInJlcGVhdCIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jaHVuaykKICAgICAgICBlbWl0KCJ1bnRpbCBub3QoIikKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LmNvbmRpdGlvbikKICAgICAgICBlbWl0KCcpJykKICAgIGVuZCwKICAgIHJlcGVhdHVudGlsID0gZnVuY3Rpb24oYXN0KQogICAgICAgIGVtaXQoInJlcGVhdCIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jaHVuaykKICAgICAgICBlbWl0KCJ1bnRpbCgiKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuY29uZGl0aW9uKQogICAgICAgIGVtaXQoJyknKQogICAgZW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgWyJyZXR1cm4iXSA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCIgcmV0dXJuICIpCiAgICAgICAgaWYgYXN0LnZhbHVlIHRoZW4KICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC52YWx1ZSkKICAgICAgICBlbmQKICAgIGVuZCwKICAgIAogICAgcmV0dXJuRnJvbUF1dG9yZWxlYXNlUG9vbCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCIgcmV0dXJuIHsnQHBvb2wnLCIpCiAgICAgICAgaWYgYXN0LnZhbHVlIHRoZW4KICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC52YWx1ZSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGVtaXQoIiBuaWwgIikKICAgICAgICBlbmQKICAgICAgICBlbWl0KCd9JykKICAgIGVuZCwKICAgIAogICAgWyJicmVhayJdID0gZnVuY3Rpb24oYXN0KQogICAgICAgIGVtaXQoImJyZWFrIikKICAgIGVuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBmdW5jdGlvbmNhbGwgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC52YWx1ZSkKICAgICAgICBlbWl0KCcoJykKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LmFyZ3MpCiAgICAgICAgZW1pdCgnKScpCiAgICBlbmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgZnVuY3Rpb25kZWYgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgaWYgbm90IGFzdC5uYW1lIHRoZW4KICAgICAgICAgICAgZW1pdCgnKCcpCiAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBlbWl0KCJcbmZ1bmN0aW9uICIpCiAgICAgICAgaWYgYXN0Lm5hbWUgdGhlbgogICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0Lm5hbWUpCiAgICAgICAgZW5kCiAgICAgICAgZW1pdCgnKCcpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5hcmdzKQogICAgICAgIGVtaXQoIilcbiIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jaHVuaykKICAgICAgICBlbWl0KCJcbmVuZFxuIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBpZiBub3QgYXN0Lm5hbWUgdGhlbgogICAgICAgICAgICBlbWl0KCcpJykKICAgICAgICBlbmQKICAgIGVuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBhc3NpZ25tZW50ID0gZnVuY3Rpb24oYXN0KQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QubGVmdCkKICAgICAgICBpZiBhc3QucmlnaHQgdGhlbgogICAgICAgICAgICBlbWl0KCc9JykKICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5yaWdodCkKICAgICAgICBlbmQKICAgIGVuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgbGlzdCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBmb3IgaSA9IDEsICNhc3QgZG8KICAgICAgICAgICAgbG9jYWwgZXhwID0gYXN0W2ldCiAgICAgICAgICAgIGlmIChpID4gMSkgdGhlbgogICAgICAgICAgICAgICAgZW1pdCgnLCcpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoZXhwKQogICAgICAgIGVuZAogICAgZW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIHRhYmxlbGl0ZXJhbCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCJ7IikKICAgICAgICBmb3IgaSA9IDEsICNhc3QgZG8KICAgICAgICAgICAgbG9jYWwgZW50cnkgPSBhc3RbaV0KICAgICAgICAgICAgaWYgKGkgPiAxKSB0aGVuCiAgICAgICAgICAgICAgICBlbWl0KCcsJykKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGlmIGVudHJ5LmtleSB0aGVuCiAgICAgICAgICAgICAgICBpZiAoZW50cnkua2V5LnR5cGUgPT0gJ2lkZW50aWZpZXInKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZW1pdChlbnRyeS5rZXkpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZW1pdCgnWycpCiAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGVudHJ5LmtleSkKICAgICAgICAgICAgICAgICAgICBlbWl0KCddJykKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVtaXQoJz0nKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGVudHJ5LnZhbHVlKQogICAgICAgIGVuZAogICAgICAgIGVtaXQoJ30nKQogICAgZW5kLAogICAgCiAgICBiaW5vcCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICByZWN1cnNpdmVseXVucGFyc2ViaW5vcChhc3QubGVmdCwgYXN0LnByZWNlZGVuY2UpCiAgICAgICAgZW1pdChhc3Qub3BlcmF0b3IpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlYmlub3AoYXN0LnJpZ2h0LCBhc3QucHJlY2VkZW5jZSkKICAgIGVuZCwKICAgIAogICAgdW5vcCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KGFzdC5vcGVyYXRvcikKICAgICAgICByZWN1cnNpdmVseXVucGFyc2ViaW5vcChhc3QudmFsdWUsIGFzdC5wcmVjZWRlbmNlKQogICAgZW5kLAogICAgCiAgICBkZXJlZiA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LmxlZnQpCiAgICAgICAgZW1pdCgnWycpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5yaWdodCkKICAgICAgICBlbWl0KCddJykKICAgIGVuZCwKICAgIAogICAgWyJsb2NhbCJdID0gZnVuY3Rpb24oYXN0KQogICAgICAgIGVtaXQoIlxubG9jYWwgIikKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LnZhbHVlKQogICAgZW5kLAogICAgCiAgICBsZWFmID0gZnVuY3Rpb24oYXN0KQogICAgICAgIGVtaXQoYXN0LnZhbHVlKQogICAgZW5kLAogICAgICAgICAgICAgICAgICAgICAgIAogICAgb2JqY19hbGxvY2F0ZUNsYXNzUGFpciA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCJvYmpjX2FsbG9jYXRlQ2xhc3NQYWlyKCIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5hcmdzKQogICAgICAgIGVtaXQoJyknKQogICAgZW5kLAogICAgCiAgICBvbHVhX2Jsb2NrID0gZnVuY3Rpb24oYXN0KQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuY2h1bmspCiAgICBlbmQsCiAgICAKICAgIG9sdWFfbWV0aG9kY2FsbCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCJbb2JqZWN0PSIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5vYmplY3QpCiAgICAgICAgZW1pdCgiIHNlbGVjdG9yPSIpCiAgICAgICAgZW1pdChhc3Quc2VsZWN0b3IpCiAgICAgICAgZW1pdCgiIGFyZ3M9eyIpCiAgICAgICAgZm9yIGkgPSAxLCAjYXN0LmFyZ3MgZG8KICAgICAgICAgICAgaWYgKGkgPiAxKSB0aGVuCiAgICAgICAgICAgICAgICBlbWl0KCcsJykKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuYXJnc1tpXSkKICAgICAgICBlbmQKICAgICAgICBlbWl0KCJ9XSIpCiAgICBlbmQsCiAgICAgICAgICAgIAogICAgb2x1YV9tZXRob2RfaW5uZXJfY2FsbCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCIgb2JqY19tc2dTZW5kKCIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5vYmplY3QpCiAgICAgICAgZW1pdCgnLCcgLi4gYXN0LnNlbGVjdG9yKQogICAgICAgIGlmICNhc3QuYXJncyA+IDAgdGhlbgogICAgICAgICAgICBlbWl0KCcsJykKICAgICAgICBlbmQKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LmFyZ3MpCiAgICAgICAgZW1pdCgnKScpCiAgICBlbmQsCiAgICAKICAgIG9sdWFfbWV0aG9kX3N1cGVyX2NhbGwgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgZW1pdCgiIG9iamNfbXNnU2VuZFN1cGVyKHNlbGYsIikKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LmFyZ3MpCiAgICAgICAgZW1pdCgnKScpCiAgICBlbmQsCgogICAgb2x1YV9jbGFzc19tZXRob2RfaW1wbGVtZW50YXRpb24gPSBmdW5jdGlvbihhc3QpCgkJcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jaHVuaykKICAgIGVuZCwKCiAgICBsdWFDbGFzc19hZGRNZXRob2QgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgaWYgYXN0Lm1ldGhvZFR5cGUgPT0gIm9iamVjdG1ldGhvZCIgdGhlbgogICAgICAgICAgICBlbWl0KCJcbmNsYXNzX2FkZEluc3RhbmNlTWV0aG9kKCciIC4uIGFzdC5jbGFzcy50ZXh0IC4uICInLCAiKQogICAgICAgIGVsc2UKICAgICAgICAgICAgZW1pdCgiXG5jbGFzc19hZGRDbGFzc01ldGhvZCgnIiAuLiBhc3QuY2xhc3MudGV4dCAuLiAiJywgIikKICAgICAgICBlbmQKICAgICAgICBlbWl0KGFzdC5zZWxlY3RvcikKCiAgICAgICAgaWYgYXN0LnJldHR5cGUgdGhlbgogICAgICAgICAgICBlbWl0KCIsJyIgLi4gYXN0LnJldHR5cGUgLi4gIiciKQogICAgICAgIGVsc2UKICAgICAgICAgICAgZW1pdCgiLG5pbCIpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgZm9yIGkgPSAxLCNhc3QuYXJndHlwZXMgZG8KICAgICAgICAgICAgZW1pdCgiLCciIC4uIGFzdC5hcmd0eXBlc1tpXSAuLiAiJyIpCiAgICAgICAgZW5kCiAgICAgICAgZW1pdCgnLCcpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5pbXApCiAgICAgICAgZW1pdCgnKScpCiAgICBlbmQsCiAgICAgICAgIAogICAgY2xhc3NfaW1wbGVtZW50YXRpb24gPSBmdW5jdGlvbihhc3QpCiAgICAgICAgZW1pdCgiXG5kb1xuIikKCQlyZWN1cnNpdmVseXVucGFyc2UoYXN0LmNodW5rKQogICAgICAgIGVtaXQoIiBvYmpjX3JlZ2lzdGVyQ2xhc3NQYWlyKCciIC4uIGFzdC5jbGFzcy50ZXh0IC4uICInKSIpCiAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jbGFzc01ldGhvZHNDaHVuaykKCQllbWl0KCIgZW5kXG4iKQogICAgZW5kLAogICAgCiAgICBvbHVhX3Byb3BlcnR5X2RlY2xlYXJhdGlvbiA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBsb2NhbCBjbGFzc05hbWUgPSBhc3QuY2xhc3MudGV4dAogICAgICAgIGxvY2FsIHByb3BlcnR5QXR0cmlidXRlID0gYXN0LmF0dHJpYnV0ZQoKICAgICAgICBlbWl0KCIgY2xhc3NfYWRkUHJvcGVydHkoJyIgLi4gY2xhc3NOYW1lIC4uICInLCAnIiAuLiBwcm9wZXJ0eUF0dHJpYnV0ZS5hdG9taWMgLi4gIicsJyIpCiAgICAgICAgZW1pdChwcm9wZXJ0eUF0dHJpYnV0ZS5vd25lcnNoaXAgLi4gIicsJyIgLi4gcHJvcGVydHlBdHRyaWJ1dGUuZ2V0dGVyIC4uICInLCciIC4uIHByb3BlcnR5QXR0cmlidXRlLnNldHRlciAuLiAiJywnIikKICAgICAgICBlbWl0KHByb3BlcnR5QXR0cmlidXRlLnR5cGUgLi4gIicsJyIgLi4gcHJvcGVydHlBdHRyaWJ1dGUubmFtZSAuLiAiJywnIiAuLiBwcm9wZXJ0eUF0dHJpYnV0ZS5pbnRlcm5hbE5hbWUgLi4gIicpIiApCiAgICBlbmQsCiAgICAKICAgIG9sdWFfY3JlYXRlU2VsZWN0b3IgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgbG9jYWwgc2VsID0gYXN0LnNlbAogICAgICAgIGVtaXQoIiBzZWxfcmVnaXN0ZXJOYW1lKCIgLi4gc2VsIC4uICcpJykKICAgIGVuZCwKICAgIAogICAgb2x1YV9nZXRQcm90b2NvbCA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBsb2NhbCBwcm90b2NvbCA9IGFzdC5wcm90b2NvbAogICAgICAgIGVtaXQoIiBvYmpjX2dldFByb3RvY29sKCIgLi4gcHJvdG9jb2wgLi4gJyknKQogICAgZW5kLAoKICAgIG9iamNfYXV0b3JlbGVhc2Vwb29sID0gZnVuY3Rpb24oYXN0KQogICAgICAgIGVtaXQoWz09WwogICAgICAgICAgICAgICAgZG8gCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgX19wb29sX18gPSBvYmpjX21zZ1NlbmQob2JqY19tc2dTZW5kKE5TQXV0b3JlbGVhc2VQb29sLCdhbGxvYycpLCAnaW5pdCcpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgX19mdW5jX189KGZ1bmN0aW9uKCkKICAgICAgICAgICAgIF09PV0KICAgICAgICAgICAgKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuYmxvY2spCiAgICAgICAgZW1pdChbPT1bIGVuZCkKICAgICAgICAgICAgbG9jYWwgX19yZXR1cm5UYWJsZV9fID0gX19mdW5jX18oKQogICAgICAgICAgICBpZiBfX3JldHVyblRhYmxlX18gdGhlbgogICAgICAgICAgICAgICAgICBsb2NhbCBfX3JldF9fPV9fcmV0dXJuVGFibGVfX1syXQogICAgICAgICAgICAgICAgICBvYmpjX3JldGFpbkJlZm9yZVJldHVybkZyb21BdXRvcmVsZWFzZVBvb2woX19yZXRfXykKICAgICAgICAgICAgICAgICAgb2JqY19tc2dTZW5kKF9fcG9vbF9fLCAncmVsZWFzZScpCiAgICAgICAgICAgICAgICAgIGNvbGxlY3RnYXJiYWdlKCJjb2xsZWN0IikKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fcmV0X18KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICBjb2xsZWN0Z2FyYmFnZSgiY29sbGVjdCIpCiAgICAgICAgICAgICAgICAgIG9iamNfbXNnU2VuZChfX3Bvb2xfXywgJ3JlbGVhc2UnKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kXT09XSkKICAgIGVuZCwKICAgIAogICAgb2x1YV9pbXBvcnRfZmlsZSA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCIgb2JqY19pbXBvcnRfZmlsZSgiIC4uIGFzdC5maWxlTmFtZSAuLiAiKVxuIikKICAgIGVuZCwKICAgIAogICAgb2x1YV90aHJvdyA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCIgb2JqY190aHJvdygiKQogICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QudmFsdWUpCiAgICAgICAgZW1pdCgnKScpCiAgICBlbmQsCiAgICBvbHVhX29iamNfZW51bWVyYXRvciA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICBlbWl0KCIgb2JqY19OU0Zhc3RFbnVtZXJhdGUoIikKICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LmFyZ3MpCiAgICAgICAgZW1pdCgnKScpCiAgICBlbmQsCiAgICBvbHVhX29iamNfYmxvY2tPYmplY3QgPSBmdW5jdGlvbihhc3QpICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCIgb2JqY19jcmVhdGVCbG9ja09iamVjdCgiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSBhc3QuYXJncwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFyZ3MgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBhcmd1bWVudFR5cGVzID0ge30KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8saSBpbiBpcGFpcnMoYXJncy5hcmd1bWVudFR5cGVzKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJndW1lbnRUeXBlc1sjYXJndW1lbnRUeXBlcyArIDFdID0gc3RyaW5nbGVhZihpLnZhbHVlLnRleHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJndW1lbnRUeXBlcy50eXBlID0gJ2xpc3QnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICNhcmd1bWVudFR5cGVzID4gMSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXJndW1lbnRUeXBlcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoJywnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoImZ1bmN0aW9uKCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXJncy5hcmd1bWVudE5hbWVzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCcpJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuYmxvY2tCb2R5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCJlbmQpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCJmdW5jdGlvbigpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5ibG9ja0JvZHkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoImVuZCkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgZW5kLAogICAgCiAgICBvbHVhX29iamNfdHJ5Y2F0Y2hmaW5hbGx5ID0gZnVuY3Rpb24oYXN0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0cnlGdW5jdGlvbk5hbWUgPSAnX190cnlCbG9ja19mdW5jXycgLi4gIG9iamNfVVVJRFN0cmluZygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNhdGNoRnVuY3Rpb25OYW1lID0gJ19fY2F0Y2hCbG9ja19mdW5jXycgLi4gb2JqY19VVUlEU3RyaW5nKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZmluYWxseUZ1bmN0aW9uTmFtZSA9ICdfX2ZpbmFsbHlCbG9ja19mdW5jXycgLi4gb2JqY19VVUlEU3RyaW5nKCkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoJ2RvIGxvY2FsICcgLi4gdHJ5RnVuY3Rpb25OYW1lIC4uICcgPWZ1bmN0aW9uKCknKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LnRyeUJsb2NrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCdcbmVuZFxuJykKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoJyBsb2NhbCAnIC4uICBjYXRjaEZ1bmN0aW9uTmFtZSAuLiAnPWZ1bmN0aW9uKCcgLi4gYXN0LmNhdGNoQmxvY2suYXJnIC4uICcpJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5jYXRjaEJsb2NrLmNodW5rKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCdcbmVuZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCcgbG9jYWwgJyAuLiBmaW5hbGx5RnVuY3Rpb25OYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBhc3QuZmluYWxseUJsb2NrIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdCgnPWZ1bmN0aW9uKCknKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5maW5hbGx5QmxvY2spCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoJ1xuZW5kXG4nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoJyBvYmpjX3RyeUNhdGNoRmluYWxseSgnIC4uIHRyeUZ1bmN0aW9uTmFtZSAuLiAnLCcgLi4gY2F0Y2hGdW5jdGlvbk5hbWUgLi4gJywnIC4uIGZpbmFsbHlGdW5jdGlvbk5hbWUgLi4gJyknKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdCgiXG5lbmQiKQogICAgZW5kLCAgICAKICAgIE5TQ29uc3RhbnRTdHJpbmcgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdCgiIF9fTlNDb25zdGFudFN0cmluZygiIC4uIGFzdC50ZXh0IC4uICcpJykKICAgIGVuZCwKICAgIE5TQ29uc3RhbnROdW1iZXIgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdCgiIF9fTlNDb25zdGFudE51bWJlcigiIC4uIGFzdC50ZXh0IC4uICcpJykKICAgIGVuZCwKICAgIG9sdWFfb2JqY19jbGFzc1ByZWRlY2xlYXJhdGlvbiA9IGZ1bmN0aW9uKGFzdCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCIgb2JqY19jbGFzc1ByZWRlY2xlYXJhdGlvbigiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QuY2xhc3NOYW1lcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCcpJykKICAgIGVuZCwKICAgIG9sdWFfb2JqY19saXRlcmFsQXJyYXkgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdCgiIG9iamNfY3JlYXRlTGl0ZXJhbEFycmF5KCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoMjE5MCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAjYXN0LmFyZ3MgPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdC5hcmdzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoJyknKQogICAgZW5kLAogICAgb2x1YV9vYmpjX2xpdGVyYWxEaWN0aW9uYXJ5ID0gZnVuY3Rpb24oYXN0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCJvYmpjX2NyZWF0ZUxpdGVyYWxEaWN0aW9uYXJ5KCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgjYXN0LmtleXMgPiAwKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0LmtleXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0KCcsJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QudmFsdWVzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdCgnKScpCiAgICBlbmQsCn0KCnJlY3Vyc2l2ZWx5dW5wYXJzZWJpbm9wID0gZnVuY3Rpb24oYXN0LCB0aGlzcHJlY2VkZW5jZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3QudHlwZSA9PSAiYmlub3AiKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChub3QgYXN0LnByZWNlZGVuY2Ugb3Igbm90IHRoaXNwcmVjZWRlbmNlIG9yIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhc3QucHJlY2VkZW5jZSA8IHRoaXNwcmVjZWRlbmNlKSkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXQoJygnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZWx5dW5wYXJzZShhc3QpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdCgnKScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlbHl1bnBhcnNlKGFzdCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKcmVjdXJzaXZlbHl1bnBhcnNlID0gZnVuY3Rpb24oYXN0KQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB0ID0gdHlwZXRhYmxlW2FzdC50eXBlXQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaywgdiBpbiBwYWlycyhhc3QpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoImssdiIsIGssIHYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCJVbmtub3duIEFTVCBub2RlIHR5cGUgIi4uYXN0LnR5cGUpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAoKICAgICAgICAgICAgICAgICAgICAgICAgdChhc3QpCiAgICAgICAgICAgICAgICAgICAgICBlbmQKCmxvY2FsIG5lZWRzc3BhY2UgPQp7CglzdHJpbmcgPSB0cnVlLAoJbnVtYmVyID0gdHJ1ZSwKCWlkZW50aWZpZXIgPSB0cnVlLAoJa2V5d29yZCA9IHRydWUKfQoKbG9jYWwgdW5wYXJzZXIgPSBmdW5jdGlvbihhc3QpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge30KICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVseXVucGFyc2UoYXN0KQoKICAgICAgICAgICAgICAgICAgICBsb2NhbCBsaW5lID0gMQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxhc3R0eXBlID0gbmlsCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgcyA9IHt9CiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHQgaW4gaXBhaXJzKHJlc3VsdCkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdHlwZSh0KSA9PSAnc3RyaW5nJyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBpc3N0cmluZyA9IHQ6ZmluZCgiXlsld19dKiQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmVlZHNzcGFjZVtsYXN0dHlwZV0gYW5kIGlzc3RyaW5nIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzWyNzKzFdID0gIiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzWyNzKzFdID0gdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNzdHJpbmcgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3R0eXBlID0gJ3N0cmluZycKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0dHlwZSA9IG5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHQubGluZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGxpbmUgPCB0LmxpbmUpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0tc1sjcysxXSA9ICJcbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZSA9IGxpbmUgKyAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3R0eXBlID0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBuZWVkc3NwYWNlW2xhc3R0eXBlXSBhbmQgbmVlZHNzcGFjZVt0LnR5cGVdIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzWyNzKzFdID0gIiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzWyNzKzFdID0gdC50ZXh0CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdHR5cGUgPSB0LnR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWJsZS5jb25jYXQocykKICAgICAgICAgICAgICAgIGVuZAoKCnRyYW5zbGF0ZSA9IGZ1bmN0aW9uKGludGV4dCwgZW5naW5lKQogICAgICAgICAgICAgICAgZ19FbmdpbmUgPSBlbmdpbmUKICAgICAgICAgICAgICAgIGxvY2FsIHJlc3VsdCA9IHVucGFyc2VyKHBhcnNlcihpbnRleHQsIG5pbCkpCiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgICAgICAgICAtLXJldHVybiBzdHJpbmcuZ3N1YihyZXN1bHQsICIoXG4rKSIsICJcbiIpCiAgICAgICAgICAgIGVuZAo="
